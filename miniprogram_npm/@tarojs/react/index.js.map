{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar shared = require('@tarojs/shared');\nvar runtime = require('@tarojs/runtime');\nvar Reconciler = require('react-reconciler');\nvar constants = require('react-reconciler/constants');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar Reconciler__default = /*#__PURE__*/_interopDefaultLegacy(Reconciler);\n\nfunction isEventName(s) {\n    return s[0] === 'o' && s[1] === 'n';\n}\nvar IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;\nfunction updateProps(dom, oldProps, newProps) {\n    var updatePayload = getUpdatePayload(dom, oldProps, newProps);\n    if (updatePayload) {\n        updatePropsByPayload(dom, oldProps, updatePayload);\n    }\n}\nfunction updatePropsByPayload(dom, oldProps, updatePayload) {\n    for (var i = 0; i < updatePayload.length; i += 2) { // key, value 成对出现\n        var key = updatePayload[i];\n        var newProp = updatePayload[i + 1];\n        var oldProp = oldProps[key];\n        setProperty(dom, key, newProp, oldProp);\n    }\n}\nfunction getUpdatePayload(dom, oldProps, newProps) {\n    var i;\n    var updatePayload = null;\n    for (i in oldProps) {\n        if (!(i in newProps)) {\n            (updatePayload = updatePayload || []).push(i, null);\n        }\n    }\n    var isFormElement = dom instanceof runtime.FormElement;\n    for (i in newProps) {\n        if (oldProps[i] !== newProps[i] || (isFormElement && i === 'value')) {\n            (updatePayload = updatePayload || []).push(i, newProps[i]);\n        }\n    }\n    return updatePayload;\n}\n// function eventProxy (e: CommonEvent) {\n//   const el = document.getElementById(e.currentTarget.id)\n//   const handlers = el!.__handlers[e.type]\n//   handlers[0](e)\n// }\nfunction setEvent(dom, name, value, oldValue) {\n    var isCapture = name.endsWith('Capture');\n    var eventName = name.toLowerCase().slice(2);\n    if (isCapture) {\n        eventName = eventName.slice(0, -7);\n    }\n    var compName = shared.capitalize(shared.toCamelCase(dom.tagName.toLowerCase()));\n    if (eventName === 'click' && compName in shared.internalComponents) {\n        eventName = 'tap';\n    }\n    if (shared.isFunction(value)) {\n        if (oldValue) {\n            dom.removeEventListener(eventName, oldValue, false);\n            dom.addEventListener(eventName, value, { isCapture: isCapture, sideEffect: false });\n        }\n        else {\n            dom.addEventListener(eventName, value, isCapture);\n        }\n    }\n    else {\n        dom.removeEventListener(eventName, oldValue);\n    }\n}\nfunction setStyle(style, key, value) {\n    if (key[0] === '-') {\n        style.setProperty(key, value.toString());\n        // css variables need not further judgment\n        return;\n    }\n    style[key] =\n        shared.isNumber(value) && IS_NON_DIMENSIONAL.test(key) === false\n            ? value + 'px'\n            : value == null\n                ? ''\n                : value;\n}\nfunction setProperty(dom, name, value, oldValue) {\n    var _a, _b;\n    name = name === 'className' ? 'class' : name;\n    if (name === 'key' ||\n        name === 'children' ||\n        name === 'ref') ;\n    else if (name === 'style') {\n        var style = dom.style;\n        if (shared.isString(value)) {\n            style.cssText = value;\n        }\n        else {\n            if (shared.isString(oldValue)) {\n                style.cssText = '';\n                oldValue = null;\n            }\n            if (shared.isObject(oldValue)) {\n                for (var i in oldValue) {\n                    if (!(value && i in value)) {\n                        setStyle(style, i, '');\n                    }\n                }\n            }\n            if (shared.isObject(value)) {\n                for (var i$1 in value) {\n                    if (!oldValue || value[i$1] !== oldValue[i$1]) {\n                        setStyle(style, i$1, value[i$1]);\n                    }\n                }\n            }\n        }\n    }\n    else if (isEventName(name)) {\n        setEvent(dom, name, value, oldValue);\n    }\n    else if (name === 'dangerouslySetInnerHTML') {\n        var newHtml = (_a = value === null || value === void 0 ? void 0 : value.__html) !== null && _a !== void 0 ? _a : '';\n        var oldHtml = (_b = oldValue === null || oldValue === void 0 ? void 0 : oldValue.__html) !== null && _b !== void 0 ? _b : '';\n        if (newHtml || oldHtml) {\n            if (oldHtml !== newHtml) {\n                dom.innerHTML = newHtml;\n            }\n        }\n    }\n    else if (!shared.isFunction(value)) {\n        if (value == null) {\n            dom.removeAttribute(name);\n        }\n        else {\n            dom.setAttribute(name, value);\n        }\n    }\n}\n\n/* eslint-disable @typescript-eslint/indent */\nvar hostConfig = {\n    // below keys order by {React ReactFiberHostConfig.custom.js}, convenient for comparing each other.\n    // -------------------\n    // required by @types/react-reconciler\n    // -------------------\n    getPublicInstance: function getPublicInstance(inst) {\n        return inst;\n    },\n    getRootHostContext: function getRootHostContext() {\n        return {};\n    },\n    getChildHostContext: function getChildHostContext(parentHostContext) {\n        return parentHostContext;\n    },\n    prepareForCommit: function prepareForCommit() {\n\n        return null;\n    },\n    resetAfterCommit: shared.noop,\n    createInstance: function createInstance(type) {\n        return runtime.document.createElement(type);\n    },\n    appendInitialChild: function appendInitialChild(parent, child) {\n        parent.appendChild(child);\n    },\n    finalizeInitialChildren: function finalizeInitialChildren(dom, _, props) {\n        updateProps(dom, {}, props); // 提前执行更新属性操作，Taro 在 Page 初始化后会立即从 dom 读取必要信息\n        return false;\n    },\n    prepareUpdate: function prepareUpdate(instance, _, oldProps, newProps) {\n        return getUpdatePayload(instance, oldProps, newProps);\n    },\n    shouldSetTextContent: function shouldSetTextContent() {\n        return false;\n    },\n    createTextInstance: function createTextInstance(text) {\n        return runtime.document.createTextNode(text);\n    },\n    scheduleTimeout: setTimeout,\n    cancelTimeout: clearTimeout,\n    noTimeout: -1,\n    isPrimaryRenderer: true,\n    warnsIfNotActing: true,\n    supportsMutation: true,\n    supportsPersistence: false,\n    supportsHydration: false,\n    getInstanceFromNode: function () { return null; },\n    beforeActiveInstanceBlur: shared.noop,\n    afterActiveInstanceBlur: shared.noop,\n    preparePortalMount: shared.noop,\n    prepareScopeUpdate: shared.noop,\n    getInstanceFromScope: function () { return null; },\n    getCurrentEventPriority: function getCurrentEventPriority() {\n        return constants.DefaultEventPriority;\n    },\n    detachDeletedInstance: shared.noop,\n    // -------------------\n    //      Microtasks\n    //     (optional)\n    // -------------------\n    supportsMicrotasks: true,\n    scheduleMicrotask: shared.isUndefined(Promise)\n        ? setTimeout\n        : function (callback) { return Promise.resolve(null)\n            .then(callback)\n            .catch(function (error) {\n            setTimeout(function () {\n                throw error;\n            });\n        }); },\n    // -------------------\n    //      Mutation\n    //     (required if supportsMutation is true)\n    // -------------------\n    appendChild: function appendChild(parent, child) {\n        parent.appendChild(child);\n    },\n    appendChildToContainer: function appendChildToContainer(parent, child) {\n        parent.appendChild(child);\n    },\n    commitTextUpdate: function commitTextUpdate(textInst, _, newText) {\n        textInst.nodeValue = newText;\n    },\n    commitMount: shared.noop,\n    commitUpdate: function commitUpdate(dom, updatePayload, _, oldProps) {\n        updatePropsByPayload(dom, oldProps, updatePayload);\n    },\n    insertBefore: function insertBefore(parent, child, refChild) {\n        parent.insertBefore(child, refChild);\n    },\n    insertInContainerBefore: function insertInContainerBefore(parent, child, refChild) {\n        parent.insertBefore(child, refChild);\n    },\n    removeChild: function removeChild(parent, child) {\n        parent.removeChild(child);\n    },\n    removeChildFromContainer: function removeChildFromContainer(parent, child) {\n        parent.removeChild(child);\n    },\n    resetTextContent: shared.noop,\n    hideInstance: function hideInstance(instance) {\n        var style = instance.style;\n        style.setProperty('display', 'none');\n    },\n    hideTextInstance: function hideTextInstance(textInstance) {\n        textInstance.nodeValue = '';\n    },\n    unhideInstance: function unhideInstance(instance, props) {\n        var styleProp = props.style;\n        var display = (styleProp === null || styleProp === void 0 ? void 0 : styleProp.hasOwnProperty('display')) ? styleProp.display : null;\n        display = display == null || shared.isBoolean(display) || display === '' ? '' : ('' + display).trim();\n        // eslint-disable-next-line dot-notation\n        instance.style['display'] = display;\n    },\n    unhideTextInstance: function unhideTextInstance(textInstance, text) {\n        textInstance.nodeValue = text;\n    },\n    clearContainer: function clearContainer(element) {\n        if (element.childNodes.length > 0) {\n            element.textContent = '';\n        }\n    },\n};\nvar TaroReconciler = Reconciler__default[\"default\"](hostConfig);\nif (process.env.NODE_ENV !== 'production') {\n    var foundDevTools = TaroReconciler.injectIntoDevTools({\n        bundleType: 1,\n        version: '18.0.0',\n        rendererPackageName: 'taro-react',\n    });\n    if (!foundDevTools) {\n        // eslint-disable-next-line no-console\n        console.info('%cDownload the React DevTools ' +\n            'for a better development experience: ' +\n            'https://reactjs.org/link/react-devtools', 'font-weight:bold');\n    }\n}\n\nvar ContainerMap = new WeakMap();\nvar Root = function Root(renderer, domContainer, options) {\n    this.renderer = renderer;\n    this.initInternalRoot(renderer, domContainer, options);\n};\nRoot.prototype.initInternalRoot = function initInternalRoot (renderer, domContainer, options) {\n    // Since react-reconciler v0.27, createContainer need more parameters\n    // @see:https://github.com/facebook/react/blob/0b974418c9a56f6c560298560265dcf4b65784bc/packages/react-reconciler/src/ReactFiberReconciler.js#L248\n    var containerInfo = domContainer;\n    if (options) {\n        var tag = 1; // ConcurrentRoot\n        var concurrentUpdatesByDefaultOverride = false;\n        var isStrictMode = false;\n        var identifierPrefix = '';\n        var onRecoverableError = function (error) { return console.error(error); };\n        var transitionCallbacks = null;\n        if (options.unstable_strictMode === true) {\n            isStrictMode = true;\n        }\n        if (options.identifierPrefix !== undefined) {\n            identifierPrefix = options.identifierPrefix;\n        }\n        if (options.onRecoverableError !== undefined) {\n            onRecoverableError = options.onRecoverableError;\n        }\n        if (options.unstable_transitionCallbacks !== undefined) {\n            transitionCallbacks = options.unstable_transitionCallbacks;\n        }\n        this.internalRoot = renderer.createContainer(containerInfo, tag, null, // hydrationCallbacks\n        isStrictMode, concurrentUpdatesByDefaultOverride, identifierPrefix, onRecoverableError, transitionCallbacks);\n    }\n    else {\n        var tag$1 = 0; // LegacyRoot\n        this.internalRoot = renderer.createContainer(containerInfo, tag$1, null, // hydrationCallbacks\n        false, // isStrictMode\n        false, // concurrentUpdatesByDefaultOverride,\n        '', // identifierPrefix\n        function () { }, // onRecoverableError, this isn't reachable because onRecoverableError isn't called in the legacy API.\n        null // transitionCallbacks\n        );\n    }\n};\nRoot.prototype.render = function render (children, cb) {\n    var ref = this;\n        var renderer = ref.renderer;\n        var internalRoot = ref.internalRoot;\n    renderer.updateContainer(children, internalRoot, null, cb);\n    return renderer.getPublicRootInstance(internalRoot);\n};\nRoot.prototype.unmount = function unmount (cb) {\n    this.renderer.updateContainer(null, this.internalRoot, null, cb);\n};\nfunction render(element, domContainer, cb) {\n    var oldRoot = ContainerMap.get(domContainer);\n    if (oldRoot != null) {\n        return oldRoot.render(element, cb);\n    }\n    var root = new Root(TaroReconciler, domContainer);\n    ContainerMap.set(domContainer, root);\n    return root.render(element, cb);\n}\nfunction createRoot(domContainer, options) {\n    if ( options === void 0 ) options = {};\n\n    var oldRoot = ContainerMap.get(domContainer);\n    if (oldRoot != null) {\n        return oldRoot;\n    }\n    // options should be an object\n    var root = new Root(TaroReconciler, domContainer, options);\n    ContainerMap.set(domContainer, root);\n    return root;\n}\n\nvar unstable_batchedUpdates = TaroReconciler.batchedUpdates;\nfunction unmountComponentAtNode(dom) {\n    shared.ensure(dom && [1, 8, 9, 11].includes(dom.nodeType), 'unmountComponentAtNode(...): Target container is not a DOM element.');\n    var root = ContainerMap.get(dom);\n    if (!root)\n        { return false; }\n    unstable_batchedUpdates(function () {\n        root.unmount(function () {\n            ContainerMap.delete(dom);\n        });\n    }, null);\n    return true;\n}\nfunction findDOMNode(comp) {\n    if (comp == null) {\n        return null;\n    }\n    var nodeType = comp.nodeType;\n    if (nodeType === 1 || nodeType === 3) {\n        return comp;\n    }\n    return TaroReconciler.findHostInstance(comp);\n}\nvar portalType = shared.isFunction(Symbol) && Symbol.for\n    ? Symbol.for('react.portal')\n    : 0xeaca;\nfunction createPortal(children, containerInfo, key) {\n    return {\n        $$typeof: portalType,\n        key: key == null ? null : String(key),\n        children: children,\n        containerInfo: containerInfo,\n        implementation: null\n    };\n}\nvar index = {\n    render: render,\n    createRoot: createRoot,\n    unstable_batchedUpdates: unstable_batchedUpdates,\n    unmountComponentAtNode: unmountComponentAtNode,\n    findDOMNode: findDOMNode,\n    createPortal: createPortal\n};\n\nexports.createPortal = createPortal;\nexports.createRoot = createRoot;\nexports[\"default\"] = index;\nexports.findDOMNode = findDOMNode;\nexports.render = render;\nexports.unmountComponentAtNode = unmountComponentAtNode;\nexports.unstable_batchedUpdates = unstable_batchedUpdates;\n//# sourceMappingURL=index.js.map\n"]}