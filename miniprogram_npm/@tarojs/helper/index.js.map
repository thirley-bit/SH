{"version":3,"sources":["index.js","dist/index.js","dist/babelRegister.js","dist/constants.js","dist/terminal.js","dist/npm.js","dist/utils.js","dist/swcRegister.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;ACFA,ADGA;ACFA;AACA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ACHA,AFMA;ACFA,ACHA,AFMA;ACFA,ACHA,AFMA;ACFA,ACHA,AFMA,AGTA;AFOA,ACHA,AFMA,AGTA;AFOA,ACHA,AFMA,AGTA;AFOA,ACHA,AFMA,AIZA,ADGA;AFOA,ACHA,AFMA,AIZA,ADGA;AFOA,ACHA,AFMA,AIZA,ADGA;AFOA,ACHA,AFMA,AIZA,ADGA,AENA;AJaA,ACHA,AFMA,AIZA,ADGA,AENA;AJaA,ACHA,AFMA,AIZA,ADGA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,AHSA,AENA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AFMA,AIZA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,AENA,ADGA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AJaA,ACHA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AENA,ACHA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AHUA,AGTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["module.exports = require('./dist/index.js')\n\nmodule.exports.default = module.exports\n","\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createSwcRegister = exports.npm = exports.injectDefineConfigHeader = exports.createBabelRegister = exports.createDebug = exports.fs = exports.chokidar = void 0;\nexports.chokidar = __importStar(require(\"chokidar\"));\nexports.fs = __importStar(require(\"fs-extra\"));\nconst createDebug = (id) => require('debug')(id);\nexports.createDebug = createDebug;\nvar babelRegister_1 = require(\"./babelRegister\");\nObject.defineProperty(exports, \"createBabelRegister\", { enumerable: true, get: function () { return __importDefault(babelRegister_1).default; } });\nObject.defineProperty(exports, \"injectDefineConfigHeader\", { enumerable: true, get: function () { return babelRegister_1.injectDefineConfigHeader; } });\n__exportStar(require(\"./constants\"), exports);\nexports.npm = __importStar(require(\"./npm\"));\nvar swcRegister_1 = require(\"./swcRegister\");\nObject.defineProperty(exports, \"createSwcRegister\", { enumerable: true, get: function () { return __importDefault(swcRegister_1).default; } });\n__exportStar(require(\"./terminal\"), exports);\n__exportStar(require(\"./utils\"), exports);\n//# sourceMappingURL=index.js.map","\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.injectDefineConfigHeader = void 0;\nconst path = __importStar(require(\"path\"));\n/**\n * Inject `defineAppConfig` and `definePageConfig`\n * require header at the top of a config file,\n * without the need to specifically require them\n * if they are used\n*/\nfunction injectDefineConfigHeader(babel) {\n    const appConfig = 'function defineAppConfig(config) { return config }';\n    const pageConfig = 'function definePageConfig(config) { return config }';\n    const prependHeader = (nodePath, header) => {\n        const parsedHeader = babel.parse(header, { filename: '' }).program.body[0];\n        nodePath.node.body.unshift(parsedHeader);\n    };\n    const enterHandler = (nodePath) => {\n        const { scope, node } = nodePath;\n        scope.traverse(node, {\n            CallExpression(p) {\n                const callee = p.node.callee;\n                // @ts-ignore\n                switch (callee.name) {\n                    case 'defineAppConfig':\n                        return prependHeader(nodePath, appConfig);\n                    case 'definePageConfig':\n                        return prependHeader(nodePath, pageConfig);\n                }\n            }\n        });\n    };\n    return {\n        visitor: {\n            Program: { enter: enterHandler }\n        }\n    };\n}\nexports.injectDefineConfigHeader = injectDefineConfigHeader;\nfunction createBabelRegister({ only }) {\n    require('@babel/register')({\n        only: Array.from(new Set([...only])),\n        presets: [\n            require.resolve('@babel/preset-env'),\n            require.resolve('@babel/preset-typescript')\n        ],\n        plugins: [\n            injectDefineConfigHeader,\n            [require.resolve('@babel/plugin-proposal-decorators'), {\n                    legacy: true\n                }],\n            require.resolve('@babel/plugin-proposal-object-rest-spread'),\n            [require.resolve('@babel/plugin-transform-runtime'), {\n                    corejs: false,\n                    helpers: true,\n                    regenerator: true,\n                    useESModules: false,\n                    version: '^7.7.7',\n                    absoluteRuntime: path.resolve(__dirname, '..', 'node_modules/@babel/runtime')\n                }]\n        ],\n        extensions: ['.jsx', '.js', '.ts', '.tsx'],\n        babelrc: false,\n        configFile: false,\n        cache: false\n    });\n}\nexports.default = createBabelRegister;\n//# sourceMappingURL=babelRegister.js.map","\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TARO_BASE_CONFIG = exports.TARO_CONFIG_FOLDER = exports.DEFAULT_TEMPLATE_SRC_GITEE = exports.DEFAULT_TEMPLATE_SRC = exports.isWindows = exports.DEVICE_RATIO_NAME = exports.taroJsMobxCommon = exports.taroJsMobx = exports.taroJsRedux = exports.taroJsFramework = exports.taroJsQuickAppComponents = exports.taroJsComponents = exports.META_TYPE = exports.UPDATE_PACKAGE_LIST = exports.FILE_PROCESSOR_MAP = exports.DEVICE_RATIO = exports.PROJECT_CONFIG = exports.NODE_MODULES_REG = exports.NODE_MODULES = exports.CSS_IMPORT_REG = exports.REG_URL = exports.REG_WXML_IMPORT = exports.REG_TEMPLATE = exports.REG_UX = exports.REG_JSON = exports.REG_FONT = exports.REG_IMAGE = exports.REG_MEDIA = exports.REG_CSS = exports.REG_STYLE = exports.REG_STYLUS = exports.REG_LESS = exports.REG_SASS_SCSS = exports.REG_SASS_SASS = exports.REG_SASS = exports.REG_VUE = exports.REG_SCRIPTS = exports.REG_TYPESCRIPT = exports.REG_SCRIPT = exports.REG_JS = exports.VUE_EXT = exports.SCRIPT_EXT = exports.UX_EXT = exports.TS_EXT = exports.JS_EXT = exports.SCSS_EXT = exports.CSS_EXT = exports.processTypeMap = exports.processTypeEnum = exports.PLATFORMS = void 0;\nexports.FRAMEWORK_MAP = exports.ENTRY = exports.NPM_DIR = exports.TEMP_DIR = exports.SOURCE_DIR = exports.OUTPUT_DIR = void 0;\nconst os = __importStar(require(\"os\"));\nconst terminal_1 = require(\"./terminal\");\n// eslint-disable-next-line dot-notation\nexports.PLATFORMS = global['PLATFORMS'] = global['PLATFORMS'] || {};\nvar processTypeEnum;\n(function (processTypeEnum) {\n    processTypeEnum[\"START\"] = \"start\";\n    processTypeEnum[\"CREATE\"] = \"create\";\n    processTypeEnum[\"COMPILE\"] = \"compile\";\n    processTypeEnum[\"CONVERT\"] = \"convert\";\n    processTypeEnum[\"COPY\"] = \"copy\";\n    processTypeEnum[\"GENERATE\"] = \"generate\";\n    processTypeEnum[\"MODIFY\"] = \"modify\";\n    processTypeEnum[\"ERROR\"] = \"error\";\n    processTypeEnum[\"WARNING\"] = \"warning\";\n    processTypeEnum[\"UNLINK\"] = \"unlink\";\n    processTypeEnum[\"REFERENCE\"] = \"reference\";\n    processTypeEnum[\"REMIND\"] = \"remind\";\n})(processTypeEnum = exports.processTypeEnum || (exports.processTypeEnum = {}));\nexports.processTypeMap = {\n    [\"create\" /* processTypeEnum.CREATE */]: {\n        name: '创建',\n        color: 'cyan'\n    },\n    [\"compile\" /* processTypeEnum.COMPILE */]: {\n        name: '编译',\n        color: 'green'\n    },\n    [\"convert\" /* processTypeEnum.CONVERT */]: {\n        name: '转换',\n        color: terminal_1.chalk.rgb(255, 136, 0)\n    },\n    [\"copy\" /* processTypeEnum.COPY */]: {\n        name: '拷贝',\n        color: 'magenta'\n    },\n    [\"generate\" /* processTypeEnum.GENERATE */]: {\n        name: '生成',\n        color: 'blue'\n    },\n    [\"modify\" /* processTypeEnum.MODIFY */]: {\n        name: '修改',\n        color: 'yellow'\n    },\n    [\"error\" /* processTypeEnum.ERROR */]: {\n        name: '错误',\n        color: 'red'\n    },\n    [\"warning\" /* processTypeEnum.WARNING */]: {\n        name: '警告',\n        color: 'yellowBright'\n    },\n    [\"unlink\" /* processTypeEnum.UNLINK */]: {\n        name: '删除',\n        color: 'magenta'\n    },\n    [\"start\" /* processTypeEnum.START */]: {\n        name: '启动',\n        color: 'green'\n    },\n    [\"reference\" /* processTypeEnum.REFERENCE */]: {\n        name: '引用',\n        color: 'blue'\n    },\n    [\"remind\" /* processTypeEnum.REMIND */]: {\n        name: '提示',\n        color: 'green'\n    }\n};\nexports.CSS_EXT = ['.css', '.scss', '.sass', '.less', '.styl', '.stylus', '.wxss', '.acss'];\nexports.SCSS_EXT = ['.scss'];\nexports.JS_EXT = ['.js', '.jsx'];\nexports.TS_EXT = ['.ts', '.tsx'];\nexports.UX_EXT = ['.ux'];\nexports.SCRIPT_EXT = exports.JS_EXT.concat(exports.TS_EXT);\nexports.VUE_EXT = ['.vue'];\nexports.REG_JS = /\\.js(\\?.*)?$/;\nexports.REG_SCRIPT = /\\.(js|jsx)(\\?.*)?$/;\nexports.REG_TYPESCRIPT = /\\.(tsx|ts)(\\?.*)?$/;\nexports.REG_SCRIPTS = /\\.[tj]sx?$/i;\nexports.REG_VUE = /\\.vue$/i;\nexports.REG_SASS = /\\.(s[ac]ss)$/;\nexports.REG_SASS_SASS = /\\.sass$/;\nexports.REG_SASS_SCSS = /\\.scss$/;\nexports.REG_LESS = /\\.less$/;\nexports.REG_STYLUS = /\\.styl(us)?$/;\nexports.REG_STYLE = /\\.(css|scss|sass|less|styl|stylus|wxss|acss|ttss|jxss|qss)(\\?.*)?$/;\nexports.REG_CSS = /\\.(css|wxss|acss|ttss)(\\?.*)?$/;\nexports.REG_MEDIA = /\\.(mp4|webm|ogg|mp3|m4a|wav|flac|aac)(\\?.*)?$/;\nexports.REG_IMAGE = /\\.(png|jpe?g|gif|bpm|svg|webp)(\\?.*)?$/;\nexports.REG_FONT = /\\.(woff2?|eot|ttf|otf)(\\?.*)?$/;\nexports.REG_JSON = /\\.json(\\?.*)?$/;\nexports.REG_UX = /\\.ux(\\?.*)?$/;\nexports.REG_TEMPLATE = /\\.(wxml|axml|ttml|qml|swan|jxml)(\\?.*)?$/;\nexports.REG_WXML_IMPORT = /<import(.*)?src=(?:(?:'([^']*)')|(?:\"([^\"]*)\"))/gi;\nexports.REG_URL = /^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i;\nexports.CSS_IMPORT_REG = /@import ([\"'])(.+?)\\1;/g;\nexports.NODE_MODULES = 'node_modules';\nexports.NODE_MODULES_REG = /(.*)node_modules/;\nexports.PROJECT_CONFIG = 'config/index';\nexports.DEVICE_RATIO = {\n    640: 2.34 / 2,\n    750: 1,\n    828: 1.81 / 2\n};\nexports.FILE_PROCESSOR_MAP = {\n    '.js': 'babel',\n    '.scss': 'sass',\n    '.sass': 'sass',\n    '.less': 'less',\n    '.styl': 'stylus'\n};\nexports.UPDATE_PACKAGE_LIST = [\n    'babel-plugin-transform-react-jsx-to-rn-stylesheet',\n    'taro-css-to-react-native',\n    'stylelint-config-taro-rn',\n    'stylelint-taro-rn',\n    'babel-plugin-transform-taroapi',\n    'babel-preset-taro',\n    'eslint-config-taro',\n    'postcss-html-transform',\n    'postcss-plugin-constparse',\n    'postcss-pxtransform',\n    '@tarojs/shared',\n    '@tarojs/taro',\n    '@tarojs/cli',\n    '@tarojs/api',\n    '@tarojs/components',\n    '@tarojs/components-react',\n    '@tarojs/components-rn',\n    '@tarojs/extend',\n    '@tarojs/taro-h5',\n    '@tarojs/taro-rn',\n    '@tarojs/rn-runner',\n    '@tarojs/rn-style-transformer',\n    '@tarojs/rn-supporter',\n    '@tarojs/rn-transformer',\n    '@tarojs/helper',\n    '@tarojs/taro-loader',\n    '@tarojs/mini-runner',\n    '@tarojs/react',\n    '@tarojs/plugin-framework-react',\n    '@tarojs/plugin-framework-vue2',\n    '@tarojs/plugin-framework-vue3',\n    '@tarojs/plugin-react-devtools',\n    '@tarojs/plugin-vue-devtools',\n    '@tarojs/router',\n    '@tarojs/router-rn',\n    '@tarojs/runner-utils',\n    '@tarojs/runtime',\n    '@tarojs/runtime-rn',\n    '@tarojs/service',\n    '@tarojs/webpack-runner',\n    '@tarojs/with-weapp',\n    '@tarojs/taroize',\n    '@tarojs/plugin-platform-weapp',\n    '@tarojs/plugin-platform-alipay',\n    '@tarojs/plugin-platform-swan',\n    '@tarojs/plugin-platform-tt',\n    '@tarojs/plugin-platform-qq',\n    '@tarojs/plugin-platform-jd',\n    '@tarojs/plugin-platform-h5',\n    '@tarojs/plugin-html',\n    '@tarojs/plugin-mini-ci',\n    '@tarojs/webpack5-runner',\n    '@tarojs/webpack5-prebundle',\n];\nvar META_TYPE;\n(function (META_TYPE) {\n    META_TYPE[\"ENTRY\"] = \"ENTRY\";\n    META_TYPE[\"PAGE\"] = \"PAGE\";\n    META_TYPE[\"COMPONENT\"] = \"COMPONENT\";\n    META_TYPE[\"NORMAL\"] = \"NORMAL\";\n    META_TYPE[\"STATIC\"] = \"STATIC\";\n    META_TYPE[\"CONFIG\"] = \"CONFIG\";\n    META_TYPE[\"EXPORTS\"] = \"EXPORTS\";\n})(META_TYPE = exports.META_TYPE || (exports.META_TYPE = {}));\nexports.taroJsComponents = '@tarojs/components';\nexports.taroJsQuickAppComponents = '@tarojs/components-qa';\nexports.taroJsFramework = '@tarojs/taro';\nexports.taroJsRedux = '@tarojs/redux';\nexports.taroJsMobx = '@tarojs/mobx';\nexports.taroJsMobxCommon = '@tarojs/mobx-common';\nexports.DEVICE_RATIO_NAME = 'deviceRatio';\nexports.isWindows = os.platform() === 'win32';\nexports.DEFAULT_TEMPLATE_SRC = 'github:NervJS/taro-project-templates#v3.6';\nexports.DEFAULT_TEMPLATE_SRC_GITEE = 'direct:https://gitee.com/o2team/taro-project-templates.git#v3.6';\nexports.TARO_CONFIG_FOLDER = '.taro3.6';\nexports.TARO_BASE_CONFIG = 'index.json';\nexports.OUTPUT_DIR = 'dist';\nexports.SOURCE_DIR = 'src';\nexports.TEMP_DIR = '.temp';\nexports.NPM_DIR = 'npm';\nexports.ENTRY = 'app';\nvar FRAMEWORK_MAP;\n(function (FRAMEWORK_MAP) {\n    FRAMEWORK_MAP[\"VUE\"] = \"vue\";\n    FRAMEWORK_MAP[\"VUE3\"] = \"vue3\";\n    FRAMEWORK_MAP[\"REACT\"] = \"react\";\n    FRAMEWORK_MAP[\"NERV\"] = \"nerv\";\n})(FRAMEWORK_MAP = exports.FRAMEWORK_MAP || (exports.FRAMEWORK_MAP = {}));\n//# sourceMappingURL=constants.js.map","\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.terminalLink = exports.chalk = void 0;\nconst ansi_escapes_1 = __importDefault(require(\"ansi-escapes\"));\nconst chalk_1 = __importDefault(require(\"chalk\"));\nexports.chalk = chalk_1.default;\nconst supports_hyperlinks_1 = __importDefault(require(\"supports-hyperlinks\"));\nfunction terminalLink(text, url, { target = 'stdout', fallback } = {}) {\n    if (!supports_hyperlinks_1.default[target]) {\n        if (fallback === false)\n            return text;\n        return typeof fallback === 'function' ? fallback(text, url) : `${text} (\\u200B${url}\\u200B)`;\n    }\n    return ansi_escapes_1.default.link(text, url);\n}\nexports.terminalLink = terminalLink;\nterminalLink.isSupported = supports_hyperlinks_1.default.stdout;\nterminalLink.stderr = ((text, url, options = {}) => terminalLink(text, url, Object.assign({ target: 'stderr' }, options)));\nterminalLink.stderr.isSupported = supports_hyperlinks_1.default.stderr;\n//# sourceMappingURL=terminal.js.map","\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getNpmPkg = exports.getNpmPkgSync = exports.callPluginSync = exports.callPlugin = exports.installNpmPkg = exports.resolveNpmSync = exports.resolveNpm = exports.taroPluginPrefix = void 0;\nconst terminal_1 = require(\"./terminal\");\nconst Util = __importStar(require(\"./utils\"));\nconst PEERS = /UNMET PEER DEPENDENCY ([a-z\\-0-9.]+)@(.+)/gm;\nconst npmCached = {};\nconst erroneous = [];\nconst defaultInstallOptions = {\n    dev: false,\n    peerDependencies: true\n};\nexports.taroPluginPrefix = '@tarojs/plugin-';\nfunction resolveNpm(pluginName, root) {\n    const resolvePath = require('resolve');\n    if (!npmCached[pluginName]) {\n        return new Promise((resolve, reject) => {\n            resolvePath(`${pluginName}`, { basedir: root }, (err, res) => {\n                if (err) {\n                    return reject(err);\n                }\n                npmCached[pluginName] = res;\n                resolve(res || '');\n            });\n        });\n    }\n    return Promise.resolve(npmCached[pluginName]);\n}\nexports.resolveNpm = resolveNpm;\nfunction resolveNpmSync(pluginName, root) {\n    const resolvePath = require('resolve');\n    try {\n        if (!npmCached[pluginName]) {\n            const res = resolvePath.sync(pluginName, { basedir: root });\n            return res;\n        }\n        return npmCached[pluginName];\n    }\n    catch (err) {\n        if (err.code === 'MODULE_NOT_FOUND') {\n            console.log(terminal_1.chalk.cyan(`缺少npm包${pluginName}，开始安装...`));\n            const installOptions = {\n                dev: false\n            };\n            if (pluginName.indexOf(exports.taroPluginPrefix) >= 0) {\n                installOptions.dev = true;\n            }\n            installNpmPkg(pluginName, installOptions);\n            return resolveNpmSync(pluginName, root);\n        }\n        return '';\n    }\n}\nexports.resolveNpmSync = resolveNpmSync;\nfunction installNpmPkg(pkgList, options) {\n    if (!pkgList) {\n        return;\n    }\n    if (!Array.isArray(pkgList)) {\n        pkgList = [pkgList];\n    }\n    pkgList = pkgList.filter(dep => {\n        return erroneous.indexOf(dep) === -1;\n    });\n    if (!pkgList.length) {\n        return;\n    }\n    options = Object.assign({}, defaultInstallOptions, options);\n    let installer = '';\n    let args = [];\n    if (Util.shouldUseYarn()) {\n        installer = 'yarn';\n    }\n    else if (Util.shouldUseCnpm()) {\n        installer = 'cnpm';\n    }\n    else {\n        installer = 'npm';\n    }\n    if (Util.shouldUseYarn()) {\n        args = ['add'].concat(pkgList).filter(Boolean);\n        args.push('--silent', '--no-progress');\n        if (options.dev) {\n            args.push('-D');\n        }\n    }\n    else {\n        args = ['install'].concat(pkgList).filter(Boolean);\n        args.push('--silent', '--no-progress');\n        if (options.dev) {\n            args.push('--save-dev');\n        }\n        else {\n            args.push('--save');\n        }\n    }\n    const spawn = require('cross-spawn');\n    const output = spawn.sync(installer, args, {\n        stdio: ['ignore', 'pipe', 'inherit']\n    });\n    if (output.status) {\n        pkgList.forEach(dep => {\n            erroneous.push(dep);\n        });\n    }\n    let matches = null;\n    const peers = [];\n    while ((matches = PEERS.exec(output.stdout))) {\n        const pkg = matches[1];\n        const version = matches[2];\n        if (version.match(' ')) {\n            peers.push(pkg);\n        }\n        else {\n            peers.push(`${pkg}@${version}`);\n        }\n    }\n    if (options.peerDependencies && peers.length) {\n        console.info('正在安装 peerDependencies...');\n        installNpmPkg(peers, options);\n    }\n    return output;\n}\nexports.installNpmPkg = installNpmPkg;\nconst callPlugin = (pluginName, content, file, config, root) => __awaiter(void 0, void 0, void 0, function* () {\n    const pluginFn = yield getNpmPkg(`${exports.taroPluginPrefix}${pluginName}`, root);\n    return pluginFn(content, file, config);\n});\nexports.callPlugin = callPlugin;\nconst callPluginSync = (pluginName, content, file, config, root) => {\n    const pluginFn = getNpmPkgSync(`${exports.taroPluginPrefix}${pluginName}`, root);\n    return pluginFn(content, file, config);\n};\nexports.callPluginSync = callPluginSync;\nfunction getNpmPkgSync(npmName, root) {\n    const npmPath = resolveNpmSync(npmName, root);\n    const npmFn = require(npmPath);\n    return npmFn;\n}\nexports.getNpmPkgSync = getNpmPkgSync;\nfunction getNpmPkg(npmName, root) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let npmPath;\n        try {\n            npmPath = resolveNpmSync(npmName, root);\n        }\n        catch (err) {\n            if (err.code === 'MODULE_NOT_FOUND') {\n                console.log(terminal_1.chalk.cyan(`缺少npm包${npmName}，开始安装...`));\n                const installOptions = {\n                    dev: false\n                };\n                if (npmName.indexOf(exports.taroPluginPrefix) >= 0) {\n                    installOptions.dev = true;\n                }\n                installNpmPkg(npmName, installOptions);\n                npmPath = yield resolveNpm(npmName, root);\n            }\n        }\n        const npmFn = require(npmPath);\n        return npmFn;\n    });\n}\nexports.getNpmPkg = getNpmPkg;\n//# sourceMappingURL=npm.js.map","\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.readConfig = exports.readPageConfig = exports.removeHeadSlash = exports.getModuleDefaultExport = exports.addPlatforms = exports.extnameExpRegOf = exports.readDirWithFileTypes = exports.getAllFilesInFolder = exports.unzip = exports.applyArrayedVisitors = exports.mergeVisitors = exports.recursiveMerge = exports.getInstalledNpmPkgVersion = exports.getInstalledNpmPkgPath = exports.pascalCase = exports.emptyDirectory = exports.cssImports = exports.generateConstantsList = exports.generateEnvList = exports.resolveScriptPath = exports.resolveMainFilePath = exports.isEmptyObject = exports.shouldUseCnpm = exports.shouldUseYarn = exports.getSystemUsername = exports.getConfig = exports.getTaroPath = exports.getUserHomeDir = exports.recursiveFindNodeModules = exports.printLog = exports.resolveStylePath = exports.promoteRelativePath = exports.replaceAliasPath = exports.isAliasPath = exports.isQuickAppPkg = exports.isNpmPkg = exports.isNodeModule = exports.normalizePath = void 0;\nconst child_process = __importStar(require(\"child_process\"));\nconst fs = __importStar(require(\"fs-extra\"));\nconst lodash_1 = require(\"lodash\");\nconst os = __importStar(require(\"os\"));\nconst path = __importStar(require(\"path\"));\nconst constants_1 = require(\"./constants\");\nconst swcRegister_1 = __importDefault(require(\"./swcRegister\"));\nconst terminal_1 = require(\"./terminal\");\nconst execSync = child_process.execSync;\nfunction normalizePath(path) {\n    return path.replace(/\\\\/g, '/').replace(/\\/{2,}/g, '/');\n}\nexports.normalizePath = normalizePath;\nconst isNodeModule = (filename) => constants_1.NODE_MODULES_REG.test(filename);\nexports.isNodeModule = isNodeModule;\nfunction isNpmPkg(name) {\n    if (/^(\\.|\\/)/.test(name)) {\n        return false;\n    }\n    return true;\n}\nexports.isNpmPkg = isNpmPkg;\nfunction isQuickAppPkg(name) {\n    return /^@(system|service)\\.[a-zA-Z]{1,}/.test(name);\n}\nexports.isQuickAppPkg = isQuickAppPkg;\nfunction isAliasPath(name, pathAlias = {}) {\n    const prefixs = Object.keys(pathAlias);\n    if (prefixs.length === 0) {\n        return false;\n    }\n    return prefixs.includes(name) || (new RegExp(`^(${prefixs.join('|')})/`).test(name));\n}\nexports.isAliasPath = isAliasPath;\nfunction replaceAliasPath(filePath, name, pathAlias = {}) {\n    // 后续的 path.join 在遇到符号链接时将会解析为真实路径，如果\n    // 这里的 filePath 没有做同样的处理，可能会导致 import 指向\n    // 源代码文件，导致文件被意外修改\n    filePath = fs.realpathSync(filePath);\n    const prefixs = Object.keys(pathAlias);\n    if (prefixs.includes(name)) {\n        return promoteRelativePath(path.relative(filePath, fs.realpathSync(resolveScriptPath(pathAlias[name]))));\n    }\n    const reg = new RegExp(`^(${prefixs.join('|')})/(.*)`);\n    name = name.replace(reg, function (_m, $1, $2) {\n        return promoteRelativePath(path.relative(filePath, path.join(pathAlias[$1], $2)));\n    });\n    return name;\n}\nexports.replaceAliasPath = replaceAliasPath;\nfunction promoteRelativePath(fPath) {\n    const fPathArr = fPath.split(path.sep);\n    let dotCount = 0;\n    fPathArr.forEach(item => {\n        if (item.indexOf('..') >= 0) {\n            dotCount++;\n        }\n    });\n    if (dotCount === 1) {\n        fPathArr.splice(0, 1, '.');\n        return fPathArr.join('/');\n    }\n    if (dotCount > 1) {\n        fPathArr.splice(0, 1);\n        return fPathArr.join('/');\n    }\n    return normalizePath(fPath);\n}\nexports.promoteRelativePath = promoteRelativePath;\nfunction resolveStylePath(p) {\n    const realPath = p;\n    const removeExtPath = p.replace(path.extname(p), '');\n    const taroEnv = process.env.TARO_ENV;\n    for (let i = 0; i < constants_1.CSS_EXT.length; i++) {\n        const item = constants_1.CSS_EXT[i];\n        if (taroEnv) {\n            if (fs.existsSync(`${removeExtPath}.${taroEnv}${item}`)) {\n                return `${removeExtPath}.${taroEnv}${item}`;\n            }\n        }\n        if (fs.existsSync(`${p}${item}`)) {\n            return `${p}${item}`;\n        }\n    }\n    return realPath;\n}\nexports.resolveStylePath = resolveStylePath;\nfunction printLog(type, tag, filePath) {\n    const typeShow = constants_1.processTypeMap[type];\n    const tagLen = tag.replace(/[\\u0391-\\uFFE5]/g, 'aa').length;\n    const tagFormatLen = 8;\n    if (tagLen < tagFormatLen) {\n        const rightPadding = new Array(tagFormatLen - tagLen + 1).join(' ');\n        tag += rightPadding;\n    }\n    const padding = '';\n    filePath = filePath || '';\n    if (typeof typeShow.color === 'string') {\n        console.log(terminal_1.chalk[typeShow.color](typeShow.name), padding, tag, padding, filePath);\n    }\n    else {\n        console.log(typeShow.color(typeShow.name), padding, tag, padding, filePath);\n    }\n}\nexports.printLog = printLog;\nfunction recursiveFindNodeModules(filePath, lastFindPath) {\n    const findWorkspaceRoot = require('find-yarn-workspace-root');\n    if (lastFindPath && (normalizePath(filePath) === normalizePath(lastFindPath))) {\n        return filePath;\n    }\n    const dirname = path.dirname(filePath);\n    const workspaceRoot = findWorkspaceRoot(dirname);\n    const nodeModules = path.join(workspaceRoot || dirname, 'node_modules');\n    if (fs.existsSync(nodeModules)) {\n        return nodeModules;\n    }\n    if (dirname.split(path.sep).length <= 1) {\n        printLog(\"error\" /* processTypeEnum.ERROR */, `在${dirname}目录下`, '未找到node_modules文件夹，请先安装相关依赖库！');\n        return nodeModules;\n    }\n    return recursiveFindNodeModules(dirname, filePath);\n}\nexports.recursiveFindNodeModules = recursiveFindNodeModules;\nfunction getUserHomeDir() {\n    function homedir() {\n        const env = process.env;\n        const home = env.HOME;\n        const user = env.LOGNAME || env.USER || env.LNAME || env.USERNAME;\n        if (process.platform === 'win32') {\n            return env.USERPROFILE || '' + env.HOMEDRIVE + env.HOMEPATH || home || '';\n        }\n        if (process.platform === 'darwin') {\n            return home || (user ? '/Users/' + user : '');\n        }\n        if (process.platform === 'linux') {\n            return home || (process.getuid() === 0 ? '/root' : (user ? '/home/' + user : ''));\n        }\n        return home || '';\n    }\n    return typeof os.homedir === 'function' ? os.homedir() : homedir();\n}\nexports.getUserHomeDir = getUserHomeDir;\nfunction getTaroPath() {\n    const taroPath = path.join(getUserHomeDir(), constants_1.TARO_CONFIG_FOLDER);\n    if (!fs.existsSync(taroPath)) {\n        fs.ensureDirSync(taroPath);\n    }\n    return taroPath;\n}\nexports.getTaroPath = getTaroPath;\nfunction getConfig() {\n    const configPath = path.join(getTaroPath(), 'config.json');\n    if (fs.existsSync(configPath)) {\n        return require(configPath);\n    }\n    return {};\n}\nexports.getConfig = getConfig;\nfunction getSystemUsername() {\n    const userHome = getUserHomeDir();\n    const systemUsername = process.env.USER || path.basename(userHome);\n    return systemUsername;\n}\nexports.getSystemUsername = getSystemUsername;\nfunction shouldUseYarn() {\n    try {\n        execSync('yarn --version', { stdio: 'ignore' });\n        return true;\n    }\n    catch (e) {\n        return false;\n    }\n}\nexports.shouldUseYarn = shouldUseYarn;\nfunction shouldUseCnpm() {\n    try {\n        execSync('cnpm --version', { stdio: 'ignore' });\n        return true;\n    }\n    catch (e) {\n        return false;\n    }\n}\nexports.shouldUseCnpm = shouldUseCnpm;\nfunction isEmptyObject(obj) {\n    if (obj == null) {\n        return true;\n    }\n    for (const key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            return false;\n        }\n    }\n    return true;\n}\nexports.isEmptyObject = isEmptyObject;\nfunction resolveMainFilePath(p, extArrs = constants_1.SCRIPT_EXT) {\n    const realPath = p;\n    const taroEnv = process.env.TARO_ENV;\n    for (let i = 0; i < extArrs.length; i++) {\n        const item = extArrs[i];\n        if (taroEnv) {\n            if (fs.existsSync(`${p}.${taroEnv}${item}`)) {\n                return `${p}.${taroEnv}${item}`;\n            }\n            if (fs.existsSync(`${p}${path.sep}index.${taroEnv}${item}`)) {\n                return `${p}${path.sep}index.${taroEnv}${item}`;\n            }\n            if (fs.existsSync(`${p.replace(/\\/index$/, `.${taroEnv}/index`)}${item}`)) {\n                return `${p.replace(/\\/index$/, `.${taroEnv}/index`)}${item}`;\n            }\n        }\n        if (fs.existsSync(`${p}${item}`)) {\n            return `${p}${item}`;\n        }\n        if (fs.existsSync(`${p}${path.sep}index${item}`)) {\n            return `${p}${path.sep}index${item}`;\n        }\n    }\n    return realPath;\n}\nexports.resolveMainFilePath = resolveMainFilePath;\nfunction resolveScriptPath(p) {\n    return resolveMainFilePath(p);\n}\nexports.resolveScriptPath = resolveScriptPath;\nfunction generateEnvList(env) {\n    const res = {};\n    if (env && !isEmptyObject(env)) {\n        for (const key in env) {\n            try {\n                res[`process.env.${key}`] = JSON.parse(env[key]);\n            }\n            catch (err) {\n                res[`process.env.${key}`] = env[key];\n            }\n        }\n    }\n    return res;\n}\nexports.generateEnvList = generateEnvList;\nfunction generateConstantsList(constants) {\n    const res = {};\n    if (constants && !isEmptyObject(constants)) {\n        for (const key in constants) {\n            if ((0, lodash_1.isPlainObject)(constants[key])) {\n                res[key] = generateConstantsList(constants[key]);\n            }\n            else {\n                try {\n                    res[key] = JSON.parse(constants[key]);\n                }\n                catch (err) {\n                    res[key] = constants[key];\n                }\n            }\n        }\n    }\n    return res;\n}\nexports.generateConstantsList = generateConstantsList;\nfunction cssImports(content) {\n    let match;\n    const results = [];\n    content = String(content).replace(/\\/\\*.+?\\*\\/|\\/\\/.*(?=[\\n\\r])/g, '');\n    while ((match = constants_1.CSS_IMPORT_REG.exec(content))) {\n        results.push(match[2]);\n    }\n    return results;\n}\nexports.cssImports = cssImports;\n/*eslint-disable*/\nconst retries = (process.platform === 'win32') ? 100 : 1;\nfunction emptyDirectory(dirPath, opts = { excludes: [] }) {\n    if (fs.existsSync(dirPath)) {\n        fs.readdirSync(dirPath).forEach(file => {\n            const curPath = path.join(dirPath, file);\n            if (fs.lstatSync(curPath).isDirectory()) {\n                let removed = false;\n                let i = 0; // retry counter\n                do {\n                    try {\n                        if (!opts.excludes.length || !opts.excludes.some(item => curPath.indexOf(item) >= 0)) {\n                            emptyDirectory(curPath);\n                            fs.rmdirSync(curPath);\n                        }\n                        removed = true;\n                    }\n                    catch (e) {\n                    }\n                    finally {\n                        if (++i < retries) {\n                            continue;\n                        }\n                    }\n                } while (!removed);\n            }\n            else {\n                fs.unlinkSync(curPath);\n            }\n        });\n    }\n}\nexports.emptyDirectory = emptyDirectory;\n/* eslint-enable */\nconst pascalCase = (str) => str.charAt(0).toUpperCase() + (0, lodash_1.camelCase)(str.substr(1));\nexports.pascalCase = pascalCase;\nfunction getInstalledNpmPkgPath(pkgName, basedir) {\n    const resolvePath = require('resolve');\n    try {\n        return resolvePath.sync(`${pkgName}/package.json`, { basedir });\n    }\n    catch (err) {\n        return null;\n    }\n}\nexports.getInstalledNpmPkgPath = getInstalledNpmPkgPath;\nfunction getInstalledNpmPkgVersion(pkgName, basedir) {\n    const pkgPath = getInstalledNpmPkgPath(pkgName, basedir);\n    if (!pkgPath) {\n        return null;\n    }\n    return fs.readJSONSync(pkgPath).version;\n}\nexports.getInstalledNpmPkgVersion = getInstalledNpmPkgVersion;\nconst recursiveMerge = (src, ...args) => {\n    return (0, lodash_1.mergeWith)(src, ...args, (value, srcValue) => {\n        const typeValue = typeof value;\n        const typeSrcValue = typeof srcValue;\n        if (typeValue !== typeSrcValue)\n            return;\n        if (Array.isArray(value) && Array.isArray(srcValue)) {\n            return value.concat(srcValue);\n        }\n        if (typeValue === 'object') {\n            return (0, exports.recursiveMerge)(value, srcValue);\n        }\n    });\n};\nexports.recursiveMerge = recursiveMerge;\nconst mergeVisitors = (src, ...args) => {\n    const validFuncs = ['exit', 'enter'];\n    return (0, lodash_1.mergeWith)(src, ...args, (value, srcValue, key, object, srcObject) => {\n        if (!object.hasOwnProperty(key) || !srcObject.hasOwnProperty(key)) {\n            return undefined;\n        }\n        const shouldMergeToArray = validFuncs.indexOf(key) > -1;\n        if (shouldMergeToArray) {\n            return (0, lodash_1.flatMap)([value, srcValue]);\n        }\n        const [newValue, newSrcValue] = [value, srcValue].map(v => {\n            if (typeof v === 'function') {\n                return {\n                    enter: v\n                };\n            }\n            else {\n                return v;\n            }\n        });\n        return (0, exports.mergeVisitors)(newValue, newSrcValue);\n    });\n};\nexports.mergeVisitors = mergeVisitors;\nconst applyArrayedVisitors = obj => {\n    let key;\n    for (key in obj) {\n        const funcs = obj[key];\n        if (Array.isArray(funcs)) {\n            obj[key] = (astPath, ...args) => {\n                funcs.forEach(func => {\n                    func(astPath, ...args);\n                });\n            };\n        }\n        else if (typeof funcs === 'object') {\n            (0, exports.applyArrayedVisitors)(funcs);\n        }\n    }\n    return obj;\n};\nexports.applyArrayedVisitors = applyArrayedVisitors;\nfunction unzip(zipPath) {\n    const Transform = require('stream').Transform;\n    const yauzl = require('yauzl');\n    return new Promise((resolve, reject) => {\n        yauzl.open(zipPath, { lazyEntries: true }, (err, zipfile) => {\n            if (err || !zipfile)\n                throw err;\n            zipfile.on('close', () => {\n                fs.removeSync(zipPath);\n                resolve();\n            });\n            zipfile.readEntry();\n            zipfile.on('error', (err) => {\n                reject(err);\n            });\n            zipfile.on('entry', entry => {\n                if (/\\/$/.test(entry.fileName)) {\n                    const fileNameArr = entry.fileName.replace(/\\\\/g, '/').split('/');\n                    fileNameArr.shift();\n                    const fileName = fileNameArr.join('/');\n                    fs.ensureDirSync(path.join(path.dirname(zipPath), fileName));\n                    zipfile.readEntry();\n                }\n                else {\n                    zipfile.openReadStream(entry, (err, readStream) => {\n                        if (err || !readStream)\n                            throw err;\n                        const filter = new Transform();\n                        filter._transform = function (chunk, _encoding, cb) {\n                            cb(undefined, chunk);\n                        };\n                        filter._flush = function (cb) {\n                            cb();\n                            zipfile.readEntry();\n                        };\n                        const fileNameArr = normalizePath(entry.fileName).split('/');\n                        fileNameArr.shift();\n                        const fileName = fileNameArr.join('/');\n                        const writeStream = fs.createWriteStream(path.join(path.dirname(zipPath), fileName));\n                        writeStream.on('close', () => { });\n                        readStream\n                            .pipe(filter)\n                            .pipe(writeStream);\n                    });\n                }\n            });\n        });\n    });\n}\nexports.unzip = unzip;\nconst getAllFilesInFolder = (folder, filter = []) => __awaiter(void 0, void 0, void 0, function* () {\n    let files = [];\n    const list = readDirWithFileTypes(folder);\n    yield Promise.all(list.map((item) => __awaiter(void 0, void 0, void 0, function* () {\n        const itemPath = path.join(folder, item.name);\n        if (item.isDirectory) {\n            const _files = yield (0, exports.getAllFilesInFolder)(itemPath, filter);\n            files = [...files, ..._files];\n        }\n        else if (item.isFile) {\n            if (!filter.find(rule => rule === item.name))\n                files.push(itemPath);\n        }\n    })));\n    return files;\n});\nexports.getAllFilesInFolder = getAllFilesInFolder;\nfunction readDirWithFileTypes(folder) {\n    const list = fs.readdirSync(folder);\n    const res = list.map(name => {\n        const stat = fs.statSync(path.join(folder, name));\n        return {\n            name,\n            isDirectory: stat.isDirectory(),\n            isFile: stat.isFile()\n        };\n    });\n    return res;\n}\nexports.readDirWithFileTypes = readDirWithFileTypes;\nfunction extnameExpRegOf(filePath) {\n    return new RegExp(`${path.extname(filePath)}$`);\n}\nexports.extnameExpRegOf = extnameExpRegOf;\nfunction addPlatforms(platform) {\n    const upperPlatform = platform.toLocaleUpperCase();\n    if (constants_1.PLATFORMS[upperPlatform])\n        return;\n    constants_1.PLATFORMS[upperPlatform] = platform;\n}\nexports.addPlatforms = addPlatforms;\nconst getModuleDefaultExport = exports => exports.__esModule ? exports.default : exports;\nexports.getModuleDefaultExport = getModuleDefaultExport;\nfunction removeHeadSlash(str) {\n    return str.replace(/^(\\/|\\\\)/, '');\n}\nexports.removeHeadSlash = removeHeadSlash;\nfunction analyzeImport(filePath) {\n    const parser = require('@babel/parser');\n    const traverse = require('@babel/traverse').default;\n    const code = fs.readFileSync(filePath).toString();\n    let importPaths = [];\n    filePath = path.dirname(filePath);\n    const ast = parser.parse(code, {\n        sourceType: 'module',\n        plugins: [\n            'typescript',\n            'classProperties',\n            'objectRestSpread',\n            'optionalChaining'\n        ]\n    });\n    traverse(ast, {\n        ImportDeclaration({ node }) {\n            const list = [];\n            const source = node.source.value;\n            if (path.extname(source)) {\n                const importPath = path.resolve(filePath, source);\n                list.push(importPath);\n            }\n            else {\n                ['.js', '.ts', '.json'].forEach(ext => {\n                    const importPath = path.resolve(filePath, source + ext);\n                    list.push(importPath);\n                });\n            }\n            const dep = list.find(importPath => fs.existsSync(importPath));\n            if (!dep)\n                return;\n            importPaths.push(dep);\n            if (path.extname(dep) !== '.json') {\n                importPaths = importPaths.concat(analyzeImport(dep));\n            }\n        }\n    });\n    return importPaths;\n}\n// converts ast nodes to js object\nfunction exprToObject(node) {\n    const types = ['BooleanLiteral', 'StringLiteral', 'NumericLiteral'];\n    if (types.includes(node.type)) {\n        return node.value;\n    }\n    if (node.name === 'undefined' && !node.value) {\n        return undefined;\n    }\n    if (node.type === 'NullLiteral') {\n        return null;\n    }\n    if (node.type === 'ObjectExpression') {\n        return genProps(node.properties);\n    }\n    if (node.type === 'ArrayExpression') {\n        return node.elements.reduce((acc, el) => [\n            ...acc,\n            ...(el.type === 'SpreadElement'\n                ? exprToObject(el.argument)\n                : [exprToObject(el)])\n        ], []);\n    }\n}\n// converts ObjectExpressions to js object\nfunction genProps(props) {\n    return props.reduce((acc, prop) => {\n        if (prop.type === 'SpreadElement') {\n            return Object.assign(Object.assign({}, acc), exprToObject(prop.argument));\n        }\n        else if (prop.type !== 'ObjectMethod') {\n            const v = exprToObject(prop.value);\n            if (v !== undefined) {\n                return Object.assign(Object.assign({}, acc), { [prop.key.name || prop.key.value]: v });\n            }\n        }\n        return acc;\n    }, {});\n}\n// read page config from a sfc file instead of the regular config file\nfunction readSFCPageConfig(configPath) {\n    if (!fs.existsSync(configPath))\n        return {};\n    const sfcSource = fs.readFileSync(configPath, 'utf8');\n    const dpcReg = /definePageConfig\\(\\{[\\w\\W]+?\\}\\)/g;\n    const matches = sfcSource.match(dpcReg);\n    let result = {};\n    if (matches && matches.length === 1) {\n        const callExprHandler = (p) => {\n            const { callee } = p.node;\n            if (!callee.name)\n                return;\n            if (callee.name && callee.name !== 'definePageConfig')\n                return;\n            const configNode = p.node.arguments[0];\n            result = exprToObject(configNode);\n            p.stop();\n        };\n        const configSource = matches[0];\n        const babel = require('@babel/core');\n        const ast = babel.parse(configSource, { filename: '' });\n        babel.traverse(ast.program, { CallExpression: callExprHandler });\n    }\n    return result;\n}\nfunction readPageConfig(configPath) {\n    let result = {};\n    const extNames = ['.js', '.jsx', '.ts', '.tsx', '.vue'];\n    // check source file extension\n    extNames.some(ext => {\n        const tempPath = configPath.replace('.config', ext);\n        if (fs.existsSync(tempPath)) {\n            try {\n                result = readSFCPageConfig(tempPath);\n            }\n            catch (error) {\n                result = {};\n            }\n            return true;\n        }\n    });\n    return result;\n}\nexports.readPageConfig = readPageConfig;\nfunction readConfig(configPath) {\n    let result = {};\n    if (fs.existsSync(configPath)) {\n        const importPaths = constants_1.REG_SCRIPTS.test(configPath) ? analyzeImport(configPath) : [];\n        (0, swcRegister_1.default)({\n            only: [\n                fs.realpathSync(configPath),\n                // configPath might be a symlink. that will cause compilation to fail\n                filepath => importPaths.includes(filepath)\n            ],\n            plugins: [\n                [path.resolve(__dirname, '../swc/plugin-define-config/target/wasm32-wasi/release/swc_plugin_define_config.wasm'), {}]\n            ]\n        });\n        importPaths.concat([configPath]).forEach(item => {\n            delete require.cache[item];\n        });\n        result = (0, exports.getModuleDefaultExport)(require(configPath));\n    }\n    else {\n        result = readPageConfig(configPath);\n    }\n    return result;\n}\nexports.readConfig = readConfig;\n//# sourceMappingURL=utils.js.map","\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InjectDefineConfigHeader = void 0;\nconst Visitor_js_1 = require(\"@swc/core/Visitor.js\");\nclass InjectDefineConfigHeader extends Visitor_js_1.Visitor {\n    visitTsType(expression) {\n        return expression;\n    }\n    visitCallExpression(expression) {\n        const callee = expression.callee;\n        if (callee.type === 'Identifier' && (callee.value === 'definePageConfig' || callee.value === 'defineAppConfig')) {\n            return expression.arguments[0].expression;\n        }\n        return expression;\n    }\n}\nexports.InjectDefineConfigHeader = InjectDefineConfigHeader;\nfunction createSwcRegister({ only, plugins }) {\n    const config = {\n        only: Array.from(new Set([...only])),\n        jsc: {\n            parser: {\n                syntax: 'typescript',\n                decorators: true\n            },\n            transform: {\n                legacyDecorator: true\n            }\n        },\n        module: {\n            type: 'commonjs'\n        }\n    };\n    if (plugins) {\n        config.jsc.experimental = {\n            plugins\n        };\n    }\n    require('@swc/register')(config);\n}\nexports.default = createSwcRegister;\n//# sourceMappingURL=swcRegister.js.map"]}