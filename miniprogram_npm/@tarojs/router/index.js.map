{"version":3,"sources":["index.js","api.js","history.js","router/index.js","utils/index.js","router/stack.js","router/mpa.js","utils/navigate.js","router/multi-page.js","events/resize.js","events/scroll.js","tabbar.js","router/spa.js","router/page.js","animation.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;ACFA,ADGA;ACFA,ADGA;ACFA;AACA,ACHA;ADIA,ACHA;ADIA,ACHA;ADIA,ACHA,ACHA;AFOA,ACHA,ACHA;AFOA,ACHA,ACHA;AFOA,ACHA,ACHA,ACHA;AHUA,ACHA,ACHA,ACHA;AHUA,ACHA,ACHA,ACHA;AHUA,ACHA,ACHA,AENA,ADGA;AHUA,ACHA,ACHA,AENA,ADGA;AHUA,ACHA,ACHA,AENA,ADGA;AHUA,ACHA,ACHA,AGTA,ADGA,ADGA;AHUA,ACHA,ACHA,AGTA,ADGA,ADGA;AHUA,ACHA,ACHA,AGTA,ADGA,ADGA;AHUA,ACHA,ACHA,AGTA,ADGA,ADGA,AGTA;ANmBA,ACHA,ACHA,AGTA,ADGA,ADGA,AGTA;ANmBA,ACHA,ACHA,AGTA,ADGA,ADGA,AGTA;ANmBA,ACHA,ACHA,AGTA,AENA,AHSA,ADGA,AGTA;ANmBA,ACHA,ACHA,AGTA,AENA,AHSA,ADGA,AGTA;ANmBA,ACHA,ACHA,AGTA,AENA,AHSA,ADGA,AGTA;ANmBA,AQxBA,APqBA,ACHA,AGTA,AENA,AHSA,ADGA,AGTA;ANmBA,AQxBA,APqBA,ACHA,AGTA,AENA,AHSA,ADGA,AGTA;ANmBA,AQxBA,APqBA,ACHA,AGTA,AENA,AHSA,ADGA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,ACHA,AGTA,AENA,AHSA,ADGA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,ACHA,AGTA,AENA,AHSA,ADGA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,AIZA,AENA,AHSA,ADGA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,AIZA,AENA,AHSA,AMlBA,APqBA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,AIZA,AENA,AHSA,AMlBA,APqBA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,AIZA,AENA,AHSA,AMlBA,APqBA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,AIZA,AENA,AIZA,APqBA,AMlBA,APqBA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,AIZA,AENA,AIZA,APqBA,AMlBA,APqBA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,AIZA,AENA,AIZA,APqBA,AMlBA,APqBA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;ANmBA,AQxBA,ACHA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;ANmBA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,AMlBA,APqBA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,ADGA,AGTA;AOpBA,AbuCA,AS3BA,ARwBA,AIZA,AENA,AKfA,ADGA,APqBA,ADGA,AGTA;AOpBA,AbuCA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA,ADGA,AGTA;AOpBA,AbuCA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA,ADGA;AU7BA,AbuCA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA,ADGA;AU7BA,AbuCA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA,ADGA;AU7BA,AbuCA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA,ADGA;AU7BA,AbuCA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA,ADGA;AU7BA,AbuCA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA,ADGA;AHUA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AIZA,AENA,AKfA,ADGA,APqBA;AJaA,ACHA,AMlBA,AKfA,ADGA,APqBA;AJaA,ACHA,AMlBA,AKfA,ADGA,APqBA;AJaA,ACHA,AMlBA,AKfA,ADGA,APqBA;AJaA,ACHA,AMlBA,AKfA,ADGA,APqBA;AJaA,ACHA,AMlBA,AKfA,ADGA;AXkCA,ACHA,AMlBA,AKfA,ADGA;AXkCA,ACHA,AMlBA,AKfA,ADGA;AXkCA,ACHA,AMlBA,AKfA,ADGA;AXkCA,ACHA,AMlBA,AKfA,ADGA;AXkCA,ACHA,AMlBA,AKfA,ADGA;AXkCA,ACHA,AMlBA,AKfA,ADGA;AXkCA,ACHA,AMlBA,AKfA,ADGA;AXkCA,ACHA,AMlBA,AKfA,ADGA;AXkCA,ACHA,AMlBA,AKfA,ADGA;AXkCA,AOrBA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;AJaA,AKfA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["if (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var __TEMP__ = require('./api');Object.keys(__TEMP__).forEach(function(k) { if (k === \"default\" || k === \"__esModule\") return; Object.defineProperty(exports, k, { enumerable: true, configurable: true, get: function() { return __TEMP__[k]; } }); });\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var __TEMP__ = require('./history');Object.defineProperty(exports, 'history', { enumerable: true, configurable: true, get: function() { return __TEMP__.history; } });\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var __TEMP__ = require('./router/mpa');Object.defineProperty(exports, 'createMultiRouter', { enumerable: true, configurable: true, get: function() { return __TEMP__.createMultiRouter; } });\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var __TEMP__ = require('./router/spa');Object.defineProperty(exports, 'createRouter', { enumerable: true, configurable: true, get: function() { return __TEMP__.createRouter; } });\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __TEMP__ = require('history');var parsePath = __TEMP__['parsePath'];\nvar __TEMP__ = require('./history');var history = __TEMP__['history'];var prependBasename = __TEMP__['prependBasename'];\nvar __TEMP__ = require('./router');var RouterConfig = __TEMP__['RouterConfig'];\nvar __TEMP__ = require('./router/stack');var stacks = __REQUIRE_DEFAULT__(__TEMP__);\nvar __TEMP__ = require('./utils');var addLeadingSlash = __TEMP__['addLeadingSlash'];var routesAlias = __TEMP__['routesAlias'];\nfunction processNavigateUrl(option) {\n    var _a;\n    const pathPieces = parsePath(option.url);\n    // 处理相对路径\n    if ((_a = pathPieces.pathname) === null || _a === void 0 ? void 0 : _a.includes('./')) {\n        const parts = routesAlias.getOrigin(history.location.pathname).split('/');\n        parts.pop();\n        pathPieces.pathname.split('/').forEach((item) => {\n            if (item === '.') {\n                return;\n            }\n            item === '..' ? parts.pop() : parts.push(item);\n        });\n        pathPieces.pathname = parts.join('/');\n    }\n    // 处理自定义路由\n    pathPieces.pathname = routesAlias.getAlias(addLeadingSlash(pathPieces.pathname));\n    // 处理 basename\n    pathPieces.pathname = prependBasename(pathPieces.pathname);\n    // hack fix history v5 bug: https://github.com/remix-run/history/issues/814\n    if (!pathPieces.search)\n        pathPieces.search = '';\n    return pathPieces;\n}\nfunction navigate(option, method) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise((resolve, reject) => {\n            stacks.method = method;\n            const { success, complete, fail } = option;\n            const unListen = history.listen(() => {\n                const res = { errMsg: `${method}:ok` };\n                success === null || success === void 0 ? void 0 : success(res);\n                complete === null || complete === void 0 ? void 0 : complete(res);\n                resolve(res);\n                unListen();\n            });\n            try {\n                if ('url' in option) {\n                    const pathPieces = processNavigateUrl(option);\n                    const state = { timestamp: Date.now() };\n                    if (method === 'navigateTo') {\n                        history.push(pathPieces, state);\n                    }\n                    else if (method === 'redirectTo' || method === 'switchTab') {\n                        history.replace(pathPieces, state);\n                    }\n                    else if (method === 'reLaunch') {\n                        stacks.delta = stacks.length;\n                        history.replace(pathPieces, state);\n                    }\n                }\n                else if (method === 'navigateBack') {\n                    stacks.delta = option.delta;\n                    history.go(-option.delta);\n                }\n            }\n            catch (error) {\n                const res = { errMsg: `${method}:fail ${error.message || error}` };\n                fail === null || fail === void 0 ? void 0 : fail(res);\n                complete === null || complete === void 0 ? void 0 : complete(res);\n                reject(res);\n            }\n        });\n    });\n}\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function navigateTo(option) {\n    return navigate(option, 'navigateTo');\n};exports.navigateTo = navigateTo\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function redirectTo(option) {\n    return navigate(option, 'redirectTo');\n};exports.redirectTo = redirectTo\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function navigateBack(option = { delta: 1 }) {\n    if (!option.delta || option.delta < 1) {\n        option.delta = 1;\n    }\n    return navigate(option, 'navigateBack');\n};exports.navigateBack = navigateBack\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function switchTab(option) {\n    return navigate(option, 'switchTab');\n};exports.switchTab = switchTab\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function reLaunch(option) {\n    return navigate(option, 'reLaunch');\n};exports.reLaunch = reLaunch\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function getCurrentPages() {\n    if (process.env.NODE_ENV !== 'production' && RouterConfig.mode === 'multi') {\n        console.warn('多页面路由模式不支持使用 getCurrentPages 方法！');\n    }\n    const pages = stacks.get();\n    return pages.map(e => { var _a; return (Object.assign(Object.assign({}, e), { route: ((_a = e.path) === null || _a === void 0 ? void 0 : _a.replace(/\\?.*/g, '')) || '' })); });\n};exports.getCurrentPages = getCurrentPages\n","var __TEMP__ = require('history');var Action = __TEMP__['Action'];var createBrowserHistory = __TEMP__['createBrowserHistory'];var createHashHistory = __TEMP__['createHashHistory'];\nvar __TEMP__ = require('./router');var RouterConfig = __TEMP__['RouterConfig'];\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var history = exports.history = undefined;\nlet basename = '/';\nclass MpaHistory {\n    constructor() {\n        this.back = window.history.back;\n        this.forward = window.history.forward;\n        this.pushState = this.eventState('pushState');\n        this.replaceState = this.eventState('replaceState');\n    }\n    get location() {\n        return {\n            pathname: window.location.pathname,\n            search: window.location.search,\n            hash: window.location.hash,\n            key: `${window.history.length}`,\n            state: window.history.state\n        };\n    }\n    createHref(_to) {\n        throw new Error('Method not implemented.');\n    }\n    parseUrl(to) {\n        let url = to.pathname || '';\n        if (RouterConfig.isPage(url)) {\n            url += '.html';\n        }\n        if (to.search) {\n            url += `?${to.search}`;\n        }\n        if (to.hash) {\n            url += `#${to.hash}`;\n        }\n        return url;\n    }\n    push(to, _state = {}) {\n        window.location.pathname = this.parseUrl(to);\n        // this.pushState(_state, '', this.parseUrl(to))\n    }\n    replace(to, _state = {}) {\n        window.location.replace(this.parseUrl(to));\n        // this.replaceState(_state, '', this.parseUrl(to))\n    }\n    go(delta) {\n        window.history.go(delta);\n    }\n    listen(listener) {\n        function callback(e) {\n            if (e.action === 'pushState') {\n                listener({ action: Action.Push, location: this.location });\n            }\n            else if (e.action === 'replaceState') {\n                listener({ action: Action.Replace, location: this.location });\n            }\n            else {\n                // NOTE: 这里包括 back、forward、go 三种可能，并非是 POP 事件\n                listener({ action: Action.Pop, location: this.location });\n            }\n        }\n        window.addEventListener('popstate', callback);\n        return () => {\n            window.removeEventListener('popstate', callback);\n        };\n    }\n    block(_blocker) {\n        throw new Error('Method not implemented.');\n    }\n    eventState(action) {\n        return (data, unused, url) => {\n            const wrapper = window.history[action](data, unused, url);\n            const evt = new Event(action);\n            evt.action = action;\n            evt.state = data;\n            evt.unused = unused;\n            evt.url = url;\n            window.dispatchEvent(evt);\n            return wrapper;\n        };\n    }\n}\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function setHistoryMode(mode, base = '/') {\n    const options = {\n        window\n    };\n    basename = base;\n    if (mode === 'browser') {\n        history = createBrowserHistory(options);\n    }\n    else if (mode === 'multi') {\n        history = new MpaHistory();\n    }\n    else {\n        // default is hash\n        history = createHashHistory(options);\n    }\n};exports.setHistoryMode = setHistoryMode\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function prependBasename(url = '') {\n    return basename.replace(/\\/$/, '') + '/' + url.replace(/^\\//, '');\n};exports.prependBasename = prependBasename\n","var __TEMP__ = require('../utils');var addLeadingSlash = __TEMP__['addLeadingSlash'];\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });class RouterConfig {\n    static set config(e) {\n        this.__config = e;\n    }\n    static get config() {\n        return this.__config;\n    }\n    static get pages() {\n        return this.config.pages || [];\n    }\n    static get router() {\n        return this.config.router || {};\n    }\n    static get mode() {\n        return this.router.mode || 'hash';\n    }\n    static get customRoutes() { return this.router.customRoutes || {}; }\n    static isPage(url = '') {\n        return this.pages.findIndex(e => addLeadingSlash(e) === url) !== -1;\n    }\n};exports.RouterConfig = RouterConfig\n","// export const removeLeadingSlash = (str = '') => str.replace(/^\\.?\\//, '')\n// export const removeTrailingSearch = (str = '') => str.replace(/\\?[\\s\\S]*$/, '')\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var addLeadingSlash = exports.addLeadingSlash = (url = '') => (url.charAt(0) === '/' ? url : '/' + url);\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var hasBasename = exports.hasBasename = (path = '', prefix = '') => new RegExp('^' + prefix + '(\\\\/|\\\\?|#|$)', 'i').test(path) || path === prefix;\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var stripBasename = exports.stripBasename = (path = '', prefix = '') => hasBasename(path, prefix) ? path.substring(prefix.length) : path;\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var stripTrailing = exports.stripTrailing = (str = '') => str.replace(/[?#][\\s\\S]*$/, '');\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var stripSuffix = exports.stripSuffix = (path = '', suffix = '') => path.includes(suffix) ? path.substring(0, path.length - suffix.length) : path;\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var getHomePage = exports.getHomePage = (path = '', basename = '', customRoutes = {}, entryPagePath = '') => {\n    var _a;\n    const routePath = addLeadingSlash(stripBasename(path, basename));\n    const alias = ((_a = Object.entries(customRoutes).find(([key]) => key === routePath)) === null || _a === void 0 ? void 0 : _a[1]) || routePath;\n    return entryPagePath || (typeof alias === 'string' ? alias : alias[0]) || basename;\n};\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var getCurrentPage = exports.getCurrentPage = (routerMode = 'hash', basename = '/') => {\n    const pagePath = routerMode === 'hash'\n        ? location.hash.slice(1).split('?')[0]\n        : location.pathname;\n    return addLeadingSlash(stripBasename(pagePath, basename));\n};\nclass RoutesAlias {\n    constructor() {\n        this.conf = [];\n        this.getConfig = (url = '') => {\n            const customRoute = this.conf.filter((arr) => {\n                return arr.includes(url);\n            });\n            return customRoute[0];\n        };\n        this.getOrigin = (url = '') => {\n            var _a;\n            return ((_a = this.getConfig(url)) === null || _a === void 0 ? void 0 : _a[0]) || url;\n        };\n        this.getAlias = (url = '') => {\n            var _a;\n            return ((_a = this.getConfig(url)) === null || _a === void 0 ? void 0 : _a[1]) || url;\n        };\n        this.getAll = (url = '') => {\n            return this.conf\n                .filter((arr) => arr.includes(url))\n                .reduceRight((p, a) => {\n                p.unshift(a[1]);\n                return p;\n            }, []);\n        };\n    }\n    set(customRoutes = {}) {\n        for (let key in customRoutes) {\n            const path = customRoutes[key];\n            key = addLeadingSlash(key);\n            if (typeof path === 'string') {\n                this.conf.push([key, addLeadingSlash(path)]);\n            }\n            else if ((path === null || path === void 0 ? void 0 : path.length) > 0) {\n                this.conf.push(...path.map(p => [key, addLeadingSlash(p)]));\n            }\n        }\n    }\n}\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });var routesAlias = exports.routesAlias = new RoutesAlias();\n","class Stacks {\n    constructor() {\n        this.stacks = [];\n        this.backDelta = 0;\n        this.tabs = {};\n        this.methodName = '';\n    }\n    set delta(delta) {\n        if (delta > 0) {\n            this.backDelta = delta;\n        }\n        else if (this.backDelta > 0) {\n            --this.backDelta;\n        }\n        else {\n            this.backDelta = 0;\n        }\n    }\n    get delta() {\n        return this.backDelta;\n    }\n    set method(methodName) {\n        this.methodName = methodName;\n    }\n    get method() {\n        return this.methodName;\n    }\n    get length() {\n        return this.stacks.length;\n    }\n    get last() {\n        return this.stacks[this.length - 1];\n    }\n    get() {\n        return this.stacks;\n    }\n    getItem(index) {\n        return this.stacks[index];\n    }\n    getLastIndex(pathname, stateWith = 1) {\n        const list = [...this.stacks].reverse();\n        return list.findIndex((page, i) => { var _a; return i >= stateWith && ((_a = page.path) === null || _a === void 0 ? void 0 : _a.replace(/\\?.*/g, '')) === pathname; });\n    }\n    getDelta(pathname) {\n        if (this.backDelta >= 1) {\n            return this.backDelta;\n        }\n        const index = this.getLastIndex(pathname);\n        // NOTE: 此处为了修复浏览器后退多级页面，在大量重复路由状况下可能出现判断错误的情况 （增强判断能力只能考虑在 query 中新增参数来判断，暂时搁置）\n        return index > 0 ? index : 1;\n    }\n    getPrevIndex(pathname, stateWith = 1) {\n        const lastIndex = this.getLastIndex(pathname, stateWith);\n        if (lastIndex < 0) {\n            return -1;\n        }\n        return this.length - 1 - lastIndex;\n    }\n    pop() {\n        return this.stacks.pop();\n    }\n    push(page) {\n        return this.stacks.push(page);\n    }\n    getTabs() {\n        return this.tabs;\n    }\n    pushTab(path) {\n        this.tabs[path] = this.last;\n        this.pop();\n    }\n    popTab(path) {\n        this.push(this.tabs[path]);\n        delete this.tabs[path];\n    }\n    removeTab(path) {\n        delete this.tabs[path];\n    }\n}\nconst stacks = new Stacks();\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });exports.default = stacks;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/* eslint-disable dot-notation */\nvar __TEMP__ = require('@tarojs/runtime');var createPageConfig = __TEMP__['createPageConfig'];var eventCenter = __TEMP__['eventCenter'];var hooks = __TEMP__['hooks'];var incrementId = __TEMP__['incrementId'];var stringify = __TEMP__['stringify'];\nvar __TEMP__ = require('../utils/navigate');var setTitle = __TEMP__['setTitle'];\nvar __TEMP__ = require('.');var RouterConfig = __TEMP__['RouterConfig'];\nvar __TEMP__ = require('./multi-page');var MultiPageHandler = __REQUIRE_DEFAULT__(__TEMP__);\nconst createStampId = incrementId();\nconst launchStampId = createStampId();\n// TODO 支持多路由 (APP 生命周期仅触发一次)\n/** Note: 关于多页面应用\n * - 需要配置路由映射（根目录跳转、404 页面……）\n * - app.onPageNotFound 事件不支持\n * - 应用生命周期可能多次触发\n * - TabBar 会多次加载\n * - 不支持路由动画\n */\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function createMultiRouter(app, config, framework) {\n    var _a, _b, _c, _d, _e, _f;\n    return __awaiter(this, void 0, void 0, function* () {\n        RouterConfig.config = config;\n        const handler = new MultiPageHandler(config);\n        const launchParam = {\n            path: config.pageName,\n            query: handler.getQuery(launchStampId),\n            scene: 0,\n            shareTicket: '',\n            referrerInfo: {}\n        };\n        eventCenter.trigger('__taroRouterLaunch', launchParam);\n        (_a = app.onLaunch) === null || _a === void 0 ? void 0 : _a.call(app, launchParam);\n        app.onError && window.addEventListener('error', e => { var _a; return (_a = app.onError) === null || _a === void 0 ? void 0 : _a.call(app, e.message); });\n        const pathName = config.pageName;\n        const pageConfig = handler.pageConfig;\n        eventCenter.trigger('__taroRouterChange', {\n            toLocation: {\n                path: pathName\n            }\n        });\n        let element;\n        try {\n            element = yield ((_b = pageConfig.load) === null || _b === void 0 ? void 0 : _b.call(pageConfig));\n            if (element instanceof Array) {\n                element = element[0];\n            }\n        }\n        catch (error) {\n            throw new Error(error);\n        }\n        if (!element)\n            return;\n        let enablePullDownRefresh = ((_c = config === null || config === void 0 ? void 0 : config.window) === null || _c === void 0 ? void 0 : _c.enablePullDownRefresh) || false;\n        if (pageConfig) {\n            setTitle((_d = pageConfig.navigationBarTitleText) !== null && _d !== void 0 ? _d : document.title);\n            if (typeof pageConfig.enablePullDownRefresh === 'boolean') {\n                enablePullDownRefresh = pageConfig.enablePullDownRefresh;\n            }\n        }\n        const el = (_e = element.default) !== null && _e !== void 0 ? _e : element;\n        const loadConfig = Object.assign({}, pageConfig);\n        delete loadConfig['path'];\n        delete loadConfig['load'];\n        const page = createPageConfig(enablePullDownRefresh ? hooks.call('createPullDownComponent', el, location.pathname, framework, config.PullDownRefresh) : el, pathName + stringify(launchParam), {}, loadConfig);\n        handler.load(page, pageConfig);\n        (_f = app.onShow) === null || _f === void 0 ? void 0 : _f.call(app, launchParam);\n    });\n};exports.createMultiRouter = createMultiRouter\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __TEMP__ = require('mobile-detect');var MobileDetect = __REQUIRE_DEFAULT__(__TEMP__);\nlet md;\nlet preTitle = document.title;\nlet isLoadDdEntry = false;\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function getMobileDetect() {\n    if (!md) {\n        md = new MobileDetect(navigator.userAgent);\n    }\n    return md;\n};exports.getMobileDetect = getMobileDetect\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function setTitle(title) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (preTitle === title)\n            return title;\n        document.title = title;\n        preTitle = title;\n        if (process.env.SUPPORT_DINGTALK_NAVIGATE !== 'disabled' && isDingTalk()) {\n            if (!isLoadDdEntry) {\n                isLoadDdEntry = true;\n                require('dingtalk-jsapi/platform');\n            }\n            const setDingTitle = require('dingtalk-jsapi/api/biz/navigation/setTitle').default;\n            setDingTitle({ title });\n        }\n        return title;\n    });\n};exports.setTitle = setTitle\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function isWeixin() {\n    const md = getMobileDetect();\n    return md.match(/MicroMessenger/ig);\n};exports.isWeixin = isWeixin\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function isDingTalk() {\n    const md = getMobileDetect();\n    return md.match(/DingTalk/ig);\n};exports.isDingTalk = isDingTalk\n","/* eslint-disable dot-notation */\nvar __TEMP__ = require('@tarojs/runtime');var Current = __TEMP__['Current'];\nvar __TEMP__ = require('query-string');var queryString = __REQUIRE_DEFAULT__(__TEMP__);\nvar __TEMP__ = require('../events/resize');var bindPageResize = __TEMP__['bindPageResize'];\nvar __TEMP__ = require('../events/scroll');var bindPageScroll = __TEMP__['bindPageScroll'];\nvar __TEMP__ = require('../history');var setHistoryMode = __TEMP__['setHistoryMode'];\nvar __TEMP__ = require('../tabbar');var initTabbar = __TEMP__['initTabbar'];\nvar __TEMP__ = require('../utils');var addLeadingSlash = __TEMP__['addLeadingSlash'];var stripBasename = __TEMP__['stripBasename'];\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });class MultiPageHandler {\n    constructor(config) {\n        this.config = config;\n        this.mount();\n    }\n    get appId() { return this.config.appId || 'app'; }\n    get router() { return this.config.router || {}; }\n    get routerMode() { return this.router.mode || 'hash'; }\n    get customRoutes() { return this.router.customRoutes || {}; }\n    get tabBarList() { var _a; return ((_a = this.config.tabBar) === null || _a === void 0 ? void 0 : _a.list) || []; }\n    get PullDownRefresh() { return this.config.PullDownRefresh; }\n    set pathname(p) { this.router.pathname = p; }\n    get pathname() { return this.router.pathname; }\n    get basename() { return this.router.basename || ''; }\n    get pageConfig() { return this.config.route; }\n    get isTabBar() {\n        var _a;\n        const routePath = addLeadingSlash(stripBasename(this.pathname, this.basename));\n        const pagePath = ((_a = Object.entries(this.customRoutes).find(([, target]) => {\n            if (typeof target === 'string') {\n                return target === routePath;\n            }\n            else if ((target === null || target === void 0 ? void 0 : target.length) > 0) {\n                return target.includes(routePath);\n            }\n            return false;\n        })) === null || _a === void 0 ? void 0 : _a[0]) || routePath;\n        return !!pagePath && this.tabBarList.some(t => t.pagePath === pagePath);\n    }\n    get search() { return location.search.substr(1); }\n    getQuery(search = '', options = {}) {\n        search = search ? `${search}&${this.search}` : this.search;\n        const query = search\n            ? queryString.parse(search)\n            : {};\n        return Object.assign(Object.assign({}, query), options);\n    }\n    mount() {\n        setHistoryMode(this.routerMode, this.router.basename);\n        const appId = this.appId;\n        let app = document.getElementById(appId);\n        if (!app) {\n            app = document.createElement('div');\n            app.id = appId;\n        }\n        app.classList.add('taro_router');\n        if (this.tabBarList.length > 1) {\n            const container = document.createElement('div');\n            container.classList.add('taro-tabbar__container');\n            container.id = 'container';\n            const panel = document.createElement('div');\n            panel.classList.add('taro-tabbar__panel');\n            panel.appendChild(app);\n            container.appendChild(panel);\n            document.body.appendChild(container);\n            initTabbar(this.config);\n        }\n        else {\n            document.body.appendChild(app);\n        }\n    }\n    onReady(page, onLoad = true) {\n        var _a;\n        const pageEl = this.getPageContainer(page);\n        if (pageEl && !(pageEl === null || pageEl === void 0 ? void 0 : pageEl['__isReady'])) {\n            const el = pageEl.firstElementChild;\n            (_a = el === null || el === void 0 ? void 0 : el['componentOnReady']) === null || _a === void 0 ? void 0 : _a.call(el);\n            onLoad && (pageEl['__page'] = page);\n        }\n    }\n    load(page, pageConfig = {}) {\n        var _a;\n        if (!page)\n            return;\n        (_a = page.onLoad) === null || _a === void 0 ? void 0 : _a.call(page, this.getQuery('', page.options), () => {\n            var _a;\n            const pageEl = this.getPageContainer(page);\n            this.isTabBar && (pageEl === null || pageEl === void 0 ? void 0 : pageEl.classList.add('taro_tabbar_page'));\n            this.onReady(page, true);\n            (_a = page.onShow) === null || _a === void 0 ? void 0 : _a.call(page);\n            this.bindPageEvents(page, pageEl, pageConfig);\n        });\n    }\n    getPageContainer(page) {\n        var _a;\n        const path = page ? page === null || page === void 0 ? void 0 : page.path : (_a = Current.page) === null || _a === void 0 ? void 0 : _a.path;\n        const id = path === null || path === void 0 ? void 0 : path.replace(/([^a-z0-9\\u00a0-\\uffff_-])/ig, '\\\\$1');\n        if (page) {\n            return document.querySelector(`.taro_page#${id}`);\n        }\n        const el = (id\n            ? document.querySelector(`.taro_page#${id}`)\n            : document.querySelector('.taro_page') ||\n                document.querySelector('.taro_router'));\n        return el || window;\n    }\n    bindPageEvents(page, pageEl, config = {}) {\n        var _a;\n        if (!pageEl) {\n            pageEl = this.getPageContainer();\n        }\n        const distance = config.onReachBottomDistance || ((_a = this.config.window) === null || _a === void 0 ? void 0 : _a.onReachBottomDistance) || 50;\n        bindPageScroll(page, pageEl, distance);\n        bindPageResize(page);\n    }\n};exports.default = MultiPageHandler\n","let pageResizeFn;\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function bindPageResize(page) {\n    pageResizeFn && window.removeEventListener('resize', pageResizeFn);\n    pageResizeFn = function () {\n        page.onResize && page.onResize({\n            size: {\n                windowHeight: window.innerHeight,\n                windowWidth: window.innerWidth\n            }\n        });\n    };\n    window.addEventListener('resize', pageResizeFn, false);\n};exports.bindPageResize = bindPageResize\n","var __TEMP__ = require('@tarojs/runtime');var Current = __TEMP__['Current'];\nconst pageScrollFn = {};\nlet pageDOM = window;\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function bindPageScroll(page, pageEl, distance = 50) {\n    var _a;\n    const pagePath = (page ? page === null || page === void 0 ? void 0 : page.path : (_a = Current.router) === null || _a === void 0 ? void 0 : _a.path);\n    pageScrollFn[pagePath] && pageEl.removeEventListener('scroll', pageScrollFn[pagePath]);\n    pageDOM = pageEl;\n    let isReachBottom = false;\n    pageScrollFn[pagePath] = function () {\n        var _a;\n        (_a = page.onPageScroll) === null || _a === void 0 ? void 0 : _a.call(page, {\n            scrollTop: pageDOM instanceof Window ? window.scrollY : pageDOM.scrollTop\n        });\n        if (isReachBottom && getOffset() > distance) {\n            isReachBottom = false;\n        }\n        if (page.onReachBottom &&\n            !isReachBottom &&\n            getOffset() < distance) {\n            isReachBottom = true;\n            page.onReachBottom();\n        }\n    };\n    pageDOM.addEventListener('scroll', pageScrollFn[pagePath], false);\n};exports.bindPageScroll = bindPageScroll\nfunction getOffset() {\n    if (pageDOM instanceof Window) {\n        return document.documentElement.scrollHeight - window.scrollY - window.innerHeight;\n    }\n    else {\n        return pageDOM.scrollHeight - pageDOM.scrollTop - pageDOM.clientHeight;\n    }\n}\n","// @ts-nocheck\nvar __TEMP__ = require('@tarojs/taro');var initTabBarApis = __TEMP__['initTabBarApis'];\nvar __TEMP__ = require('./history');var history = __TEMP__['history'];\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function initTabbar(config) {\n    if (config.tabBar == null) {\n        return;\n    }\n    // TODO: custom-tab-bar\n    const tabbar = document.createElement('taro-tabbar');\n    const homePage = config.entryPagePath || (config.pages ? config.pages[0] : '');\n    tabbar.conf = config.tabBar;\n    tabbar.conf.homePage = history.location.pathname === '/' ? homePage : history.location.pathname;\n    const routerConfig = config.router;\n    tabbar.conf.mode = routerConfig && routerConfig.mode ? routerConfig.mode : 'hash';\n    if (routerConfig.customRoutes) {\n        tabbar.conf.custom = true;\n        tabbar.conf.customRoutes = routerConfig.customRoutes;\n    }\n    else {\n        tabbar.conf.custom = false;\n        tabbar.conf.customRoutes = {};\n    }\n    if (typeof routerConfig.basename !== 'undefined') {\n        tabbar.conf.basename = routerConfig.basename;\n    }\n    const container = document.getElementById('container');\n    container === null || container === void 0 ? void 0 : container.appendChild(tabbar);\n    initTabBarApis(config);\n};exports.initTabbar = initTabbar\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/* eslint-disable dot-notation */\nvar __TEMP__ = require('@tarojs/runtime');var createPageConfig = __TEMP__['createPageConfig'];var Current = __TEMP__['Current'];var eventCenter = __TEMP__['eventCenter'];var hooks = __TEMP__['hooks'];var incrementId = __TEMP__['incrementId'];var stringify = __TEMP__['stringify'];\nvar __TEMP__ = require('history');var LocationAction = __TEMP__['Action'];\nvar __TEMP__ = require('universal-router');var UniversalRouter = __REQUIRE_DEFAULT__(__TEMP__);\nvar __TEMP__ = require('../history');var history = __TEMP__['history'];var prependBasename = __TEMP__['prependBasename'];\nvar __TEMP__ = require('../utils');var addLeadingSlash = __TEMP__['addLeadingSlash'];var routesAlias = __TEMP__['routesAlias'];var stripBasename = __TEMP__['stripBasename'];\nvar __TEMP__ = require('../utils/navigate');var setTitle = __TEMP__['setTitle'];\nvar __TEMP__ = require('.');var RouterConfig = __TEMP__['RouterConfig'];\nvar __TEMP__ = require('./page');var PageHandler = __REQUIRE_DEFAULT__(__TEMP__);\nvar __TEMP__ = require('./stack');var stacks = __REQUIRE_DEFAULT__(__TEMP__);\nconst createStampId = incrementId();\nlet launchStampId = createStampId();\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function createRouter(app, config, framework) {\n    var _a, _b;\n    RouterConfig.config = config;\n    const handler = new PageHandler(config);\n    routesAlias.set(handler.router.customRoutes);\n    const basename = handler.router.basename;\n    const routes = handler.routes.map(route => {\n        const routePath = addLeadingSlash(route.path);\n        const paths = routesAlias.getAll(routePath);\n        return {\n            path: paths.length < 1 ? routePath : paths,\n            action: route.load\n        };\n    });\n    const router = new UniversalRouter(routes, { baseUrl: basename || '' });\n    const launchParam = {\n        path: handler.currentPage,\n        query: handler.getQuery(launchStampId),\n        scene: 0,\n        shareTicket: '',\n        referrerInfo: {}\n    };\n    eventCenter.trigger('__taroRouterLaunch', launchParam);\n    (_a = app.onLaunch) === null || _a === void 0 ? void 0 : _a.call(app, launchParam);\n    app.onError && window.addEventListener('error', e => { var _a; return (_a = app.onError) === null || _a === void 0 ? void 0 : _a.call(app, e.message); });\n    const render = ({ location, action }) => __awaiter(this, void 0, void 0, function* () {\n        var _c, _d, _e, _f, _g;\n        handler.pathname = decodeURI(location.pathname);\n        eventCenter.trigger('__taroRouterChange', {\n            toLocation: {\n                path: handler.pathname\n            }\n        });\n        let element, params;\n        try {\n            const result = yield router.resolve(handler.router.forcePath || handler.pathname);\n            [element, , params] = yield Promise.all(result);\n        }\n        catch (error) {\n            if (error.status === 404) {\n                (_c = app.onPageNotFound) === null || _c === void 0 ? void 0 : _c.call(app, {\n                    path: handler.pathname\n                });\n            }\n            else if (/Loading hot update .* failed./.test(error.message)) {\n                // NOTE: webpack5 与 prebundle 搭配使用时，开发环境下初次启动时偶发错误，由于 HMR 加载 chunk hash 错误，导致热更新失败\n                window.location.reload();\n            }\n            else {\n                throw new Error(error);\n            }\n        }\n        if (!element)\n            return;\n        const pageConfig = handler.pageConfig;\n        let enablePullDownRefresh = ((_d = config === null || config === void 0 ? void 0 : config.window) === null || _d === void 0 ? void 0 : _d.enablePullDownRefresh) || false;\n        if (pageConfig) {\n            setTitle((_e = pageConfig.navigationBarTitleText) !== null && _e !== void 0 ? _e : document.title);\n            if (typeof pageConfig.enablePullDownRefresh === 'boolean') {\n                enablePullDownRefresh = pageConfig.enablePullDownRefresh;\n            }\n        }\n        const currentPage = Current.page;\n        const pathname = handler.pathname;\n        const methodName = (_f = stacks.method) !== null && _f !== void 0 ? _f : '';\n        const cacheTabs = stacks.getTabs();\n        let shouldLoad = false;\n        stacks.method = '';\n        if (methodName === 'reLaunch') {\n            handler.unload(currentPage, stacks.length);\n            // NOTE: 同时卸载缓存在tabs里面的页面实例\n            for (const key in cacheTabs) {\n                if (cacheTabs[key]) {\n                    handler.unload(cacheTabs[key]);\n                    stacks.removeTab(key);\n                }\n            }\n            shouldLoad = true;\n        }\n        else if (currentPage && handler.isTabBar(handler.pathname)) {\n            if (handler.isSamePage(currentPage))\n                return;\n            if (handler.isTabBar(currentPage.path)) {\n                handler.hide(currentPage);\n                stacks.pushTab(currentPage.path.split('?')[0]);\n            }\n            else if (stacks.length > 0) {\n                const firstIns = stacks.getItem(0);\n                if (handler.isTabBar(firstIns.path)) {\n                    handler.unload(currentPage, stacks.length - 1);\n                    stacks.pushTab(firstIns.path.split('?')[0]);\n                }\n                else {\n                    handler.unload(currentPage, stacks.length);\n                }\n            }\n            if (cacheTabs[handler.pathname]) {\n                stacks.popTab(handler.pathname);\n                return handler.show(stacks.getItem(0), pageConfig, 0);\n            }\n            shouldLoad = true;\n        }\n        else if (action === 'POP') {\n            // NOTE: 浏览器事件退后多次时，该事件只会被触发一次\n            const prevIndex = stacks.getPrevIndex(pathname);\n            const delta = stacks.getDelta(pathname);\n            // NOTE: Safari 内核浏览器在非应用页面返回上一页时，会触发额外的 POP 事件，此处需避免当前页面被错误卸载\n            if (currentPage !== stacks.getItem(prevIndex)) {\n                handler.unload(currentPage, delta, prevIndex > -1);\n                if (prevIndex > -1) {\n                    handler.show(stacks.getItem(prevIndex), pageConfig, prevIndex);\n                }\n                else {\n                    shouldLoad = true;\n                }\n            }\n        }\n        else if (action === 'REPLACE') {\n            const delta = stacks.getDelta(pathname);\n            // NOTE: 页面路由记录并不会清空，只是移除掉缓存的 stack 以及页面\n            handler.unload(currentPage, delta);\n            shouldLoad = true;\n        }\n        else if (action === 'PUSH') {\n            handler.hide(currentPage);\n            shouldLoad = true;\n        }\n        if (shouldLoad || stacks.length < 1) {\n            const el = (_g = element.default) !== null && _g !== void 0 ? _g : element;\n            const loadConfig = Object.assign({}, pageConfig);\n            const stacksIndex = stacks.length;\n            delete loadConfig['path'];\n            delete loadConfig['load'];\n            let pageStampId = '';\n            if (launchStampId) {\n                pageStampId = launchStampId;\n                launchStampId = '';\n            }\n            else {\n                pageStampId = createStampId();\n            }\n            const page = createPageConfig(enablePullDownRefresh ? hooks.call('createPullDownComponent', el, location.pathname, framework, handler.PullDownRefresh) : el, pathname + stringify(handler.getQuery(pageStampId)), {}, loadConfig);\n            if (params)\n                page.options = params;\n            handler.load(page, pageConfig, pageStampId, stacksIndex);\n        }\n        eventCenter.trigger('__afterTaroRouterChange', {\n            toLocation: {\n                path: handler.pathname\n            }\n        });\n    });\n    const routePath = addLeadingSlash(stripBasename(history.location.pathname, handler.basename));\n    if (routePath === '/') {\n        history.replace(prependBasename(handler.homePage + history.location.search));\n    }\n    render({ location: history.location, action: LocationAction.Push });\n    (_b = app.onShow) === null || _b === void 0 ? void 0 : _b.call(app, launchParam);\n    return history.listen(render);\n};exports.createRouter = createRouter\n","/* eslint-disable dot-notation */\nvar __TEMP__ = require('@tarojs/runtime');var Current = __TEMP__['Current'];var requestAnimationFrame = __TEMP__['requestAnimationFrame'];\nvar __TEMP__ = require('query-string');var queryString = __REQUIRE_DEFAULT__(__TEMP__);\nvar __TEMP__ = require('../animation');var loadAnimateStyle = __TEMP__['loadAnimateStyle'];\nvar __TEMP__ = require('../events/resize');var bindPageResize = __TEMP__['bindPageResize'];\nvar __TEMP__ = require('../events/scroll');var bindPageScroll = __TEMP__['bindPageScroll'];\nvar __TEMP__ = require('../history');var setHistoryMode = __TEMP__['setHistoryMode'];\nvar __TEMP__ = require('../tabbar');var initTabbar = __TEMP__['initTabbar'];\nvar __TEMP__ = require('../utils');var addLeadingSlash = __TEMP__['addLeadingSlash'];var getCurrentPage = __TEMP__['getCurrentPage'];var getHomePage = __TEMP__['getHomePage'];var routesAlias = __TEMP__['routesAlias'];var stripBasename = __TEMP__['stripBasename'];var stripTrailing = __TEMP__['stripTrailing'];\nvar __TEMP__ = require('./stack');var stacks = __REQUIRE_DEFAULT__(__TEMP__);\nfunction setDisplay(el, type = '') {\n    if (el) {\n        el.style.display = type;\n    }\n}\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });class PageHandler {\n    constructor(config) {\n        this.defaultAnimation = { duration: 300, delay: 50 };\n        this.config = config;\n        this.homePage = getHomePage(this.routes[0].path, this.basename, this.customRoutes, this.config.entryPagePath);\n        this.mount();\n    }\n    get currentPage() {\n        const routePath = getCurrentPage(this.routerMode, this.basename);\n        return routePath === '/' ? this.homePage : routePath;\n    }\n    get appId() { return this.config.appId || 'app'; }\n    get router() { return this.config.router || {}; }\n    get routerMode() { return this.router.mode || 'hash'; }\n    get customRoutes() { return this.router.customRoutes || {}; }\n    get routes() { return this.config.routes || []; }\n    get tabBarList() { var _a; return ((_a = this.config.tabBar) === null || _a === void 0 ? void 0 : _a.list) || []; }\n    get PullDownRefresh() { return this.config.PullDownRefresh; }\n    get animation() { var _a, _b; return (_b = (_a = this.config) === null || _a === void 0 ? void 0 : _a.animation) !== null && _b !== void 0 ? _b : this.defaultAnimation; }\n    get animationDelay() {\n        var _a;\n        return (typeof this.animation === 'object'\n            ? this.animation.delay\n            : this.animation\n                ? (_a = this.defaultAnimation) === null || _a === void 0 ? void 0 : _a.delay\n                : 0) || 0;\n    }\n    get animationDuration() {\n        var _a;\n        return (typeof this.animation === 'object'\n            ? this.animation.duration\n            : this.animation\n                ? (_a = this.defaultAnimation) === null || _a === void 0 ? void 0 : _a.duration\n                : 0) || 0;\n    }\n    set pathname(p) { this.router.pathname = p; }\n    get pathname() { return this.router.pathname; }\n    get basename() { return this.router.basename || ''; }\n    get pageConfig() {\n        const routePath = addLeadingSlash(stripBasename(this.pathname, this.basename));\n        const homePage = addLeadingSlash(this.homePage);\n        return this.routes.find(r => {\n            var _a;\n            const pagePath = addLeadingSlash(r.path);\n            return [pagePath, homePage].includes(routePath) || ((_a = routesAlias.getConfig(pagePath)) === null || _a === void 0 ? void 0 : _a.includes(routePath));\n        });\n    }\n    isTabBar(pathname) {\n        var _a;\n        const routePath = addLeadingSlash(stripBasename(pathname, this.basename)).split('?')[0];\n        const pagePath = ((_a = Object.entries(this.customRoutes).find(([, target]) => {\n            if (typeof target === 'string') {\n                return target === routePath;\n            }\n            else if ((target === null || target === void 0 ? void 0 : target.length) > 0) {\n                return target.includes(routePath);\n            }\n            return false;\n        })) === null || _a === void 0 ? void 0 : _a[0]) || routePath;\n        return !!pagePath && this.tabBarList.some(t => stripTrailing(t.pagePath) === pagePath);\n    }\n    isSamePage(page) {\n        const routePath = stripBasename(this.pathname, this.basename);\n        const pagePath = stripBasename(page === null || page === void 0 ? void 0 : page.path, this.basename);\n        return pagePath.startsWith(routePath + '?');\n    }\n    get search() {\n        let search = '?';\n        if (this.routerMode === 'hash') {\n            const idx = location.hash.indexOf('?');\n            if (idx > -1) {\n                search = location.hash.slice(idx);\n            }\n        }\n        else {\n            search = location.search;\n        }\n        return search.substring(1);\n    }\n    getQuery(stamp = '', search = '', options = {}) {\n        search = search ? `${search}&${this.search}` : this.search;\n        const query = search\n            ? queryString.parse(search, { decode: false })\n            : {};\n        query.stamp = stamp;\n        return Object.assign(Object.assign({}, query), options);\n    }\n    mount() {\n        setHistoryMode(this.routerMode, this.router.basename);\n        this.animation && loadAnimateStyle(this.animationDuration);\n        const appId = this.appId;\n        let app = document.getElementById(appId);\n        if (!app) {\n            app = document.createElement('div');\n            app.id = appId;\n        }\n        app.classList.add('taro_router');\n        if (this.tabBarList.length > 1) {\n            const container = document.createElement('div');\n            container.classList.add('taro-tabbar__container');\n            container.id = 'container';\n            const panel = document.createElement('div');\n            panel.classList.add('taro-tabbar__panel');\n            panel.appendChild(app);\n            container.appendChild(panel);\n            document.body.appendChild(container);\n            initTabbar(this.config);\n        }\n        else {\n            document.body.appendChild(app);\n        }\n    }\n    onReady(page, onLoad = true) {\n        var _a, _b;\n        const pageEl = this.getPageContainer(page);\n        if (pageEl && !(pageEl === null || pageEl === void 0 ? void 0 : pageEl['__isReady'])) {\n            const el = pageEl.firstElementChild;\n            (_b = (_a = el === null || el === void 0 ? void 0 : el['componentOnReady']) === null || _a === void 0 ? void 0 : _a.call(el)) === null || _b === void 0 ? void 0 : _b.then(() => {\n                requestAnimationFrame(() => {\n                    var _a;\n                    (_a = page.onReady) === null || _a === void 0 ? void 0 : _a.call(page);\n                    pageEl['__isReady'] = true;\n                });\n            });\n            onLoad && (pageEl['__page'] = page);\n        }\n    }\n    load(page, pageConfig = {}, stampId, pageNo = 0) {\n        var _a, _b;\n        if (!page)\n            return;\n        // NOTE: 页面栈推入太晚可能导致 getCurrentPages 无法获取到当前页面实例\n        stacks.push(page);\n        const param = this.getQuery(stampId, '', page.options);\n        let pageEl = this.getPageContainer(page);\n        if (pageEl) {\n            setDisplay(pageEl);\n            this.isTabBar(this.pathname) && pageEl.classList.add('taro_tabbar_page');\n            this.addAnimation(pageEl, pageNo === 0);\n            (_a = page.onShow) === null || _a === void 0 ? void 0 : _a.call(page);\n            this.bindPageEvents(page, pageEl, pageConfig);\n        }\n        else {\n            (_b = page.onLoad) === null || _b === void 0 ? void 0 : _b.call(page, param, () => {\n                var _a;\n                pageEl = this.getPageContainer(page);\n                this.isTabBar(this.pathname) && (pageEl === null || pageEl === void 0 ? void 0 : pageEl.classList.add('taro_tabbar_page'));\n                this.addAnimation(pageEl, pageNo === 0);\n                this.onReady(page, true);\n                (_a = page.onShow) === null || _a === void 0 ? void 0 : _a.call(page);\n                this.bindPageEvents(page, pageEl, pageConfig);\n            });\n        }\n    }\n    unload(page, delta = 1, top = false) {\n        var _a, _b, _c;\n        if (!page)\n            return;\n        stacks.delta = --delta;\n        stacks.pop();\n        if (this.animation && top) {\n            if (this.unloadTimer) {\n                clearTimeout(this.unloadTimer);\n                (_b = (_a = this.lastUnloadPage) === null || _a === void 0 ? void 0 : _a.onUnload) === null || _b === void 0 ? void 0 : _b.call(_a);\n                this.unloadTimer = null;\n            }\n            this.lastUnloadPage = page;\n            const pageEl = this.getPageContainer(page);\n            pageEl === null || pageEl === void 0 ? void 0 : pageEl.classList.remove('taro_page_stationed');\n            pageEl === null || pageEl === void 0 ? void 0 : pageEl.classList.remove('taro_page_show');\n            this.unloadTimer = setTimeout(() => {\n                var _a, _b;\n                this.unloadTimer = null;\n                (_b = (_a = this.lastUnloadPage) === null || _a === void 0 ? void 0 : _a.onUnload) === null || _b === void 0 ? void 0 : _b.call(_a);\n            }, this.animationDuration);\n        }\n        else {\n            const pageEl = this.getPageContainer(page);\n            pageEl === null || pageEl === void 0 ? void 0 : pageEl.classList.remove('taro_page_stationed');\n            pageEl === null || pageEl === void 0 ? void 0 : pageEl.classList.remove('taro_page_show');\n            (_c = page === null || page === void 0 ? void 0 : page.onUnload) === null || _c === void 0 ? void 0 : _c.call(page);\n        }\n        if (delta >= 1)\n            this.unload(stacks.last, delta);\n    }\n    show(page, pageConfig = {}, pageNo = 0) {\n        var _a, _b;\n        if (!page)\n            return;\n        const param = this.getQuery(page['$taroParams']['stamp'], '', page.options);\n        let pageEl = this.getPageContainer(page);\n        if (pageEl) {\n            setDisplay(pageEl);\n            this.addAnimation(pageEl, pageNo === 0);\n            (_a = page.onShow) === null || _a === void 0 ? void 0 : _a.call(page);\n            this.bindPageEvents(page, pageEl, pageConfig);\n        }\n        else {\n            (_b = page.onLoad) === null || _b === void 0 ? void 0 : _b.call(page, param, () => {\n                var _a;\n                pageEl = this.getPageContainer(page);\n                this.addAnimation(pageEl, pageNo === 0);\n                this.onReady(page, false);\n                (_a = page.onShow) === null || _a === void 0 ? void 0 : _a.call(page);\n                this.bindPageEvents(page, pageEl, pageConfig);\n            });\n        }\n    }\n    hide(page) {\n        var _a;\n        if (!page)\n            return;\n        // NOTE: 修复多页并发问题，此处可能因为路由跳转过快，执行时页面可能还没有创建成功\n        const pageEl = this.getPageContainer(page);\n        if (pageEl) {\n            if (this.hideTimer) {\n                clearTimeout(this.hideTimer);\n                this.hideTimer = null;\n                setDisplay(this.lastHidePage, 'none');\n            }\n            this.lastHidePage = pageEl;\n            this.hideTimer = setTimeout(() => {\n                this.hideTimer = null;\n                setDisplay(this.lastHidePage, 'none');\n            }, this.animationDuration + this.animationDelay);\n            (_a = page.onHide) === null || _a === void 0 ? void 0 : _a.call(page);\n        }\n        else {\n            setTimeout(() => this.hide(page), 0);\n        }\n    }\n    addAnimation(pageEl, first = false) {\n        if (!pageEl)\n            return;\n        if (this.animation && !first) {\n            setTimeout(() => {\n                pageEl.classList.add('taro_page_show');\n                setTimeout(() => {\n                    pageEl.classList.add('taro_page_stationed');\n                }, this.animationDuration);\n            }, this.animationDelay);\n        }\n        else {\n            pageEl.classList.add('taro_page_show');\n            pageEl.classList.add('taro_page_stationed');\n        }\n    }\n    getPageContainer(page) {\n        var _a;\n        const path = page ? page === null || page === void 0 ? void 0 : page.path : (_a = Current.page) === null || _a === void 0 ? void 0 : _a.path;\n        const id = path === null || path === void 0 ? void 0 : path.replace(/([^a-z0-9\\u00a0-\\uffff_-])/ig, '\\\\$1');\n        if (page) {\n            return document.querySelector(`.taro_page#${id}`);\n        }\n        const el = (id\n            ? document.querySelector(`.taro_page#${id}`)\n            : document.querySelector('.taro_page') ||\n                document.querySelector('.taro_router'));\n        return el || window;\n    }\n    bindPageEvents(page, pageEl, config = {}) {\n        var _a;\n        if (!pageEl) {\n            pageEl = this.getPageContainer();\n        }\n        const distance = config.onReachBottomDistance || ((_a = this.config.window) === null || _a === void 0 ? void 0 : _a.onReachBottomDistance) || 50;\n        bindPageScroll(page, pageEl, distance);\n        bindPageResize(page);\n    }\n};exports.default = PageHandler\n","/**\n * 插入页面动画需要的样式\n */\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });function loadAnimateStyle(ms = 300) {\n    const css = `\n.taro_router .taro_page {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  background-color: #fff;\n  transform: translate(100%, 0);\n  transition: transform ${ms}ms;\n  z-index: 0;\n}\n\n.taro_router .taro_page.taro_tabbar_page,\n.taro_router .taro_page.taro_page_show.taro_page_stationed {\n  transform: none;\n}\n\n.taro_router .taro_page.taro_page_show {\n  transform: translate(0, 0);\n}`;\n    const style = document.createElement('style');\n    style.innerHTML = css;\n    document.getElementsByTagName('head')[0].appendChild(style);\n};exports.loadAnimateStyle = loadAnimateStyle\n"]}